<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>二十七. 生命周期 | 前端知识文档</title>
    <meta name="description" content="前端个人博客">
    <link rel="preload stylesheet" href="/personalblog2/assets/style.f1fd0ca1.css" as="style">
    
    <script type="module" src="/personalblog2/assets/app.04aad03c.js"></script>
    <link rel="preload" href="/personalblog2/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/personalblog2/assets/chunks/framework.cfbd61a4.js">
    <link rel="modulepreload" href="/personalblog2/assets/chunks/theme.e1e3be70.js">
    <link rel="modulepreload" href="/personalblog2/assets/interview_interview_frame.md.d75a7b71.lean.js">
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-1919c326><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-1919c326 data-v-7e5bc4a5><div class="VPNavBar has-sidebar" data-v-7e5bc4a5 data-v-a0fd61f4><div class="container" data-v-a0fd61f4><div class="title" data-v-a0fd61f4><div class="VPNavBarTitle has-sidebar" data-v-a0fd61f4 data-v-86d1bed8><a class="title" href="/personalblog2/" data-v-86d1bed8><!--[--><!--]--><!--[--><img class="VPImage logo" src="/personalblog2/txt.png" alt data-v-8426fc1a><!--]--><!--[-->博客<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-a0fd61f4><div class="curtain" data-v-a0fd61f4></div><div class="content-body" data-v-a0fd61f4><!--[--><!--]--><div class="VPNavBarSearch search" data-v-a0fd61f4><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg class="DocSearch-Search-Icon" width="20" height="20" viewBox="0 0 20 20" aria-label="search icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-a0fd61f4 data-v-7f418b0f><span id="main-nav-aria-label" class="visually-hidden" data-v-7f418b0f>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/personalblog2/guide/my.html" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>关于我</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>友情链接</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuGroup" data-v-e7ea1737 data-v-69e747b5><!----><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://www.bilibili.com/video/BV1p84y1P7Z5/" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->HTML<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://www.bilibili.com/video/BV1p84y1P7Z5/" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->CSS<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://www.bilibili.com/video/BV1YW411T7GX/" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->JavaScript基础<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://www.bilibili.com/video/BV1uK411H7on/" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->JavaScript高级<!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-e7ea1737 data-v-69e747b5><!----><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://www.bilibili.com/video/BV1gM411W7ex/" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->NodeJs<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://www.bilibili.com/video/BV14T4y1z7sw/" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->Webpack<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://www.bilibili.com/video/BV1wm4y1z7Dg" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->Git<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://www.bilibili.com/video/BV1Xy4y1v7S2/" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->TypeScript<!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-e7ea1737 data-v-69e747b5><!----><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://www.bilibili.com/video/BV1Zy4y1K7SH/" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->Vue2<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://www.bilibili.com/video/BV1Zy4y1K7SH/" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->Vue3<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://www.bilibili.com/video/BV1wy4y1D7JT/" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->React<!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>开始阅读</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/personalblog2/pages/html.html" data-v-43f1e123><!--[-->HTML<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/personalblog2/pages/css/css_attribute.html" data-v-43f1e123><!--[-->CSS<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/personalblog2/pages/js/js_basics.html" data-v-43f1e123><!--[-->JavaScript基础<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/personalblog2/pages/js_gj/js_prototype.html" data-v-43f1e123><!--[-->JavaScript高级<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/personalblog2/pages/webpack.html" data-v-43f1e123><!--[-->Webpack<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/personalblog2/pages/git/git.html" data-v-43f1e123><!--[-->Git<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/personalblog2/pages/ts/typescript.html" data-v-43f1e123><!--[-->TypeScript<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/personalblog2/pages/vue/vue2.html" data-v-43f1e123><!--[-->Vue2<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/personalblog2/pages/vue/vue3.html" data-v-43f1e123><!--[-->Vue3<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/personalblog2/pages/pinia.html" data-v-43f1e123><!--[-->Pinia<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/personalblog2/pages/react/react_basics.html" data-v-43f1e123><!--[-->React<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/personalblog2/interview/interview_basics.html" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>面试大全</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-a0fd61f4 data-v-f6a63727><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-f6a63727 data-v-ce54a7d1 data-v-b1685198><span class="check" data-v-b1685198><span class="icon" data-v-b1685198><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-ce54a7d1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-ce54a7d1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-a0fd61f4 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-f80f8133><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-a0fd61f4 data-v-40855f84 data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-9c007e85><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-9c007e85><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-40855f84><div class="item appearance" data-v-40855f84><p class="label" data-v-40855f84>Appearance</p><div class="appearance-action" data-v-40855f84><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-40855f84 data-v-ce54a7d1 data-v-b1685198><span class="check" data-v-b1685198><span class="icon" data-v-b1685198><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-ce54a7d1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-ce54a7d1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-40855f84><div class="item social-links" data-v-40855f84><div class="VPSocialLinks social-links-list" data-v-40855f84 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-f80f8133><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-a0fd61f4 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav reached-top" data-v-1919c326 data-v-79c8c1df><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-79c8c1df><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-79c8c1df><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-79c8c1df>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-79c8c1df data-v-1c15a60a><button data-v-1c15a60a>Return to top</button><!----></div></div><aside class="VPSidebar" data-v-1919c326 data-v-b00e2fdd><div class="curtain" data-v-b00e2fdd></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-b00e2fdd><span class="visually-hidden" id="sidebar-aria-label" data-v-b00e2fdd> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-b00e2fdd><section class="VPSidebarItem level-0 collapsible has-active" data-v-b00e2fdd data-v-e31bd47b><div class="item" role="button" tabindex="0" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><h2 class="text" data-v-e31bd47b>前端面试大全</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-e31bd47b><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-e31bd47b><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-e31bd47b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/personalblog2/interview/interview_basics.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>面试题之基础</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/personalblog2/interview/interview_js.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>面试题之基础作者总结</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/personalblog2/interview/interview_frame.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>面试题之框架</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/personalblog2/interview/interview_adaptation.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>面试题之大屏适配问题</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/personalblog2/interview/interview_RouteAuthority.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>面试题之路由权限问题</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-1919c326 data-v-669faec9><div class="VPDoc has-sidebar has-aside" data-v-669faec9 data-v-6b87e69f><!--[--><!--]--><div class="container" data-v-6b87e69f><div class="aside" data-v-6b87e69f><div class="aside-curtain" data-v-6b87e69f></div><div class="aside-container" data-v-6b87e69f><div class="aside-content" data-v-6b87e69f><div class="VPDocAside" data-v-6b87e69f data-v-3f215769><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-3f215769 data-v-d330b1bb><div class="content" data-v-d330b1bb><div class="outline-marker" data-v-d330b1bb></div><div class="outline-title" role="heading" aria-level="2" data-v-d330b1bb>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-d330b1bb><span class="visually-hidden" id="doc-outline-aria-label" data-v-d330b1bb> Table of Contents for current page </span><ul class="root" data-v-d330b1bb data-v-d0ee3533><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-6b87e69f><div class="content-container" data-v-6b87e69f><!--[--><!--]--><!----><main class="main" data-v-6b87e69f><div style="position:relative;" class="vp-doc _personalblog2_interview_interview_frame" data-v-6b87e69f><div><h2 id="一-vue相关的全局配置" tabindex="-1">一. Vue相关的全局配置 <a class="header-anchor" href="#一-vue相关的全局配置" aria-label="Permalink to &quot;一. Vue相关的全局配置&quot;">​</a></h2><h2 id="_1-在项目开发中是如何捕获错误的" tabindex="-1">1. 在项目开发中是如何捕获错误的？ <a class="header-anchor" href="#_1-在项目开发中是如何捕获错误的" aria-label="Permalink to &quot;1. 在项目开发中是如何捕获错误的？&quot;">​</a></h2><ul><li>可以使用try...catch...捕获错误，只能捕获一部分代码的报错</li><li>可以使用Promise的.catch方法捕获错误,但是只能捕获promise的报错</li><li>可以使用生命周期的errorCaptured捕获后代组件的错误</li><li>可以使用Vue.config.errorHandler捕获整个项目的错误</li></ul><h2 id="_2-项目上线后是如何知道出现了那些错误" tabindex="-1">2. 项目上线后是如何知道出现了那些错误？ <a class="header-anchor" href="#_2-项目上线后是如何知道出现了那些错误" aria-label="Permalink to &quot;2. 项目上线后是如何知道出现了那些错误？&quot;">​</a></h2><ul><li>可以在项目中使用上面四种捕获错误出的信息</li><li>在回调函数中使用ajax技术将错误信息全部发送到指定的服务器</li><li>最后将bug汇总到bug日志平台(禅道或者TAPD)</li></ul><h2 id="二-vue响应式原理" tabindex="-1">二. Vue响应式原理 <a class="header-anchor" href="#二-vue响应式原理" aria-label="Permalink to &quot;二. Vue响应式原理&quot;">​</a></h2><h2 id="_1-什么是数据驱动" tabindex="-1">1. 什么是数据驱动？ <a class="header-anchor" href="#_1-什么是数据驱动" aria-label="Permalink to &quot;1. 什么是数据驱动？&quot;">​</a></h2><p>进行了某些操作使数据发生了变化，导致页面用到数据的地方也发生了变化，这就是数据驱动页面。</p><h2 id="_2-什么是响应式属性-什么是非响应式属性" tabindex="-1">2. 什么是响应式属性？什么是非响应式属性？ <a class="header-anchor" href="#_2-什么是响应式属性-什么是非响应式属性" aria-label="Permalink to &quot;2. 什么是响应式属性？什么是非响应式属性？&quot;">​</a></h2><ul><li>响应式属性：当属性的属性值发生改变时，会导致页面的重新渲染，显示出最新的结果。</li><li>非响应式属性：当属性的属性值发生改变时，不会导致页面的重新渲染，最终显示的结果不变。</li></ul><h2 id="_3-如何添加属性具有响应式" tabindex="-1">3. 如何添加属性具有响应式？ <a class="header-anchor" href="#_3-如何添加属性具有响应式" aria-label="Permalink to &quot;3. 如何添加属性具有响应式？&quot;">​</a></h2><ul><li>Vue.set(哪个对象，添加什么属性，添加属性的属性值是什么)</li><li>this.$set(哪个对象，添加什么属性，添加属性的属性值是什么)</li><li>Vue.observable(object) 可以一次性添加多个响应式属性</li></ul><h2 id="_4-vue2如何可以真正的删除一个响应式数据" tabindex="-1">4. Vue2如何可以真正的删除一个响应式数据？ <a class="header-anchor" href="#_4-vue2如何可以真正的删除一个响应式数据" aria-label="Permalink to &quot;4. Vue2如何可以真正的删除一个响应式数据？&quot;">​</a></h2><ul><li>Vue.delete(target,key/index)</li><li>this.$delete(target,key/index)删除的目标，删除哪个属性</li></ul><h2 id="三-nexttick相关描述" tabindex="-1">三. nextTick相关描述 <a class="header-anchor" href="#三-nexttick相关描述" aria-label="Permalink to &quot;三. nextTick相关描述&quot;">​</a></h2><h2 id="_1-vue中数据和页面更新是同步还是异步" tabindex="-1">1. Vue中数据和页面更新是同步还是异步？ <a class="header-anchor" href="#_1-vue中数据和页面更新是同步还是异步" aria-label="Permalink to &quot;1. Vue中数据和页面更新是同步还是异步？&quot;">​</a></h2><ul><li>Vue中数据的更新是同步的，页面更新是异步的</li></ul><h2 id="_2-说说nexttick是什么" tabindex="-1">2. 说说nextTick是什么？ <a class="header-anchor" href="#_2-说说nexttick是什么" aria-label="Permalink to &quot;2. 说说nextTick是什么？&quot;">​</a></h2><p>nextTick是Vue提供的一个方法，可以接收到一个回调函数，该回调函数会在下一次DOM更新结束后执行，所以在这里面可以获取到最新的DOM节点。nextTick是一个微任务，他其实是由.then实现的。</p><h2 id="_3-nexttick实现流程" tabindex="-1">3. nextTick实现流程 <a class="header-anchor" href="#_3-nexttick实现流程" aria-label="Permalink to &quot;3. nextTick实现流程&quot;">​</a></h2><p>此处在检查当前环境是否支持Promise,如果支持,后续的nextTick就使用.then实现</p><p>如果不支持Promise,那么就检查是否支持mutationObserver</p><p>如果不支持mutationObserver,那么就检查setTimeout</p><ol><li>当调用了nextTick，会使用callbacks数组收集传入的所有回调函数。</li><li>如果是第一次调用nextTick，就会开启一个nextTick专用的微任务(其实就是.then)，后续调用nextTick不会在开启新的微任务。</li><li>在nextTick专用的微任务中，Vue会遍历callBacks数组，取出内部所有的回调函数依次执行。</li></ol><h2 id="_4-为什么它能等dom元素渲染完成后才触发回调函数" tabindex="-1">4. 为什么它能等DOM元素渲染完成后才触发回调函数？ <a class="header-anchor" href="#_4-为什么它能等dom元素渲染完成后才触发回调函数" aria-label="Permalink to &quot;4. 为什么它能等DOM元素渲染完成后才触发回调函数？&quot;">​</a></h2><p>​ 当更新data中的数据时，因为data中数据是响应式的，会同步更新数据，再通过nextTick方法将用户更新界面的方法（watcher）添加到微任务队列中，等待执行。等执行我们写的naxtTick方法时，会将回调函数放入微任务队列callBacks中，等js主线程执行完所有同步代码，就开始执行微任务队列代码，因为都是通过nextTick添加进队列的，任务的优先级是相同的，所以为先进先出原则。</p><h2 id="四-mixin-混合-混入" tabindex="-1">四. mixin(混合/混入) <a class="header-anchor" href="#四-mixin-混合-混入" aria-label="Permalink to &quot;四. mixin(混合/混入)&quot;">​</a></h2><ol><li>功能：可以将多个组件共用的配置提取成一个混入对象,可以实现代码的复用</li><li>混入分为全局混入和局部混入，全局混入使用Vue.mixin()传入一个对象，局部混入使用mixin[&#39;xxx&#39;]</li></ol><h2 id="五-computed和watch的区别" tabindex="-1">五. computed和watch的区别 <a class="header-anchor" href="#五-computed和watch的区别" aria-label="Permalink to &quot;五. computed和watch的区别&quot;">​</a></h2><p>相同点：他们都可以监视某个数据的变化,如果数据变化了就执行对应的回调函数</p><ol><li><p>computed：要用的属性不存在，要通过以有的属性计算得来，内部有缓存机制。</p></li><li><p>watch：它可以监听某个数据的变化，并在数据变化时执行一些操作。</p></li><li><p>computed可以实现的watch都可以实现，watch可以实现的computed不一定能实现，watch可以进行异步操作，computend不能进行异步操作，因为computend是通过返回值来确定计算值的。</p></li></ol><p>总的来说computed更注重于计算的结果，watch更注重于过程。computed计算出来的属性可以直接使用，他会出现在组件实例身上，watch的属性名是代表需要监视哪个数据。</p><h2 id="六-vue组件通信的方式" tabindex="-1">六. Vue组件通信的方式 <a class="header-anchor" href="#六-vue组件通信的方式" aria-label="Permalink to &quot;六.  Vue组件通信的方式&quot;">​</a></h2><h2 id="_1-props组件通信" tabindex="-1">1. props组件通信 <a class="header-anchor" href="#_1-props组件通信" aria-label="Permalink to &quot;1. props组件通信&quot;">​</a></h2><ol><li><p>使用场景：父子组件通信</p><ol><li>父组件在子组件标签上，添加标签属性，将要传递的数据放到标签属性中。</li><li>子组件想要接收父组件传递的props值，要写一个props配置项向进行接收，声明想要接收那些数据。</li><li>接收到的props数据不能修改，vue底层会监视对props的修改，然后发出相应的警告，若业务需求确实需要修改，那么请复制props的内容到data中一份，然后去修改data中的数据。</li></ol></li><li><p>子向父传</p><ol><li>父组件在子组件标签上，添加标签属性，将一个函数传递给子组件，函数的回调留在自身接收数据。</li><li>子组件通过props接收到这个函数，使用this.$eimt触发这个函数，然后传递用参数的方式传递数据给父组件。</li><li>在父组件点回调中库接收到一个参数为子组件传递的参数</li></ol></li></ol><h2 id="_2-provide-inject" tabindex="-1">2. provide/inject <a class="header-anchor" href="#_2-provide-inject" aria-label="Permalink to &quot;2. provide/inject&quot;">​</a></h2><ol><li><p>使用场景:祖孙组件之间</p></li><li><p>暴露数据</p><ol><li>祖先组件在自己的配置对象中,添加provide属性,属性值类型为对象,可以将需要暴露的数据以属性名和属性值的格式,写在provide对象即可</li></ol></li><li><p>获取数据</p><ol><li>后代组件在自己的配置对象中,添加inject属性,属性值类型string[ ],可以接收到指定属性名的数据</li></ol></li><li><p>注意:</p><ol><li>provide暴露的数据,本身是非响应式的,如果想要有响应式效果,需要自己处理该数据</li><li>provide如果使用函数写法,就可以读取data中的数据,来向外暴露,可以实现数据的灵活性</li><li>如果想让provide暴露的数据是响应式的,可以将对象放在data中先处理之后,在用provide暴露</li></ol></li></ol><h2 id="_3-自定义事件" tabindex="-1">3. 自定义事件 <a class="header-anchor" href="#_3-自定义事件" aria-label="Permalink to &quot;3. 自定义事件&quot;">​</a></h2><ol><li><p>使用场景：子向父传参</p></li><li><p><strong>面试题:区分原生事件和自定义事件</strong></p><ol><li>原生事件的事件名都已经被规定好了，直接使用即可</li><li>自定义事件是Vue专门给组件通信提供的，事件名都是开发者自己制定，符合规范就行</li></ol></li><li><p><strong>面试题2:如何区分一个事件是原生事件还是自定义事件?</strong></p><ol><li>原生事件一般是绑定在原生DOM标签上。</li><li>自定义事件一般是绑定在组件标签上。但是可以加上.native修饰符让自定义事件转为原生事件，并绑定在组件的根节点上。</li></ol></li><li><p>四个基础API</p><ol><li>$on-&gt;可以给某个组件实例,绑定自定义事件以及事件处理器</li><li>$once-&gt;可以给某个组件实例,绑定自定义事件以及事件处理器,但是这个事件只能触发一次 <ol><li>触发一次之后,会自动解绑</li></ol></li><li>$emit-&gt;可以触发某个组件实例身上的某类事件</li><li>$off-&gt;可以移除某个实例对象身上的事件 <ol><li>如果没有传入任何参数,就代表移除当前实例对象上所有的事件</li><li>如果只传入一个参数,就代表移除当前实例对象上对应类型的事件,以及他所有的事件处理器</li><li>如果传入两个参数,就代表溢出当前实例对象上对应类型事件中,对应的事件处理器</li></ol></li></ol></li><li><p>v-model指令(双向数据绑定)</p><ol><li><p>对input标签使用</p><ol><li><p>将data中的状态数据,作为默认值,显示在input框中(<strong>属性名value</strong>)</p></li><li><p>当用户修改input框的数据时,会自动修改data中对应的状态属性(<strong>事件名是input</strong>)</p></li><li><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">input</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">type</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;text&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">:value</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;msg&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">@input</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;msg=$event.target.value&quot;</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">input</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">type</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;text&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">:value</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;msg&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">@input</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;msg=$event.target.value&quot;</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li></ol></li><li><p>对组件标签使用</p><ol><li><p>将data中的状态数据,作为标签属性传给子组件(<strong>默认属性名value</strong>)</p><ol><li>同时还会给子组件绑定一个自定义事件(<strong>默认事件名input</strong>)</li></ol></li><li><p>子组件可以通过自定义事件,来修改父组件的数据</p></li><li><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#FDAEB7;font-style:italic;">HelloWorld</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">:value</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;msg&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">@input</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;(data)=&gt;msg=data&quot;</span><span style="color:#E1E4E8;">/&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#B31D28;font-style:italic;">HelloWorld</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">:value</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;msg&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">@input</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;(data)=&gt;msg=data&quot;</span><span style="color:#24292E;">/&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p>注意:<strong>默认属性名和事件名都是可以通过model属性进行配置修改的</strong></p></li></ol></li></ol></li><li><p>.sync修饰符</p><ol><li>通过标签属性的形式,将数据传递给子组件使用(标签属性名自定义)</li><li>子组件中,声明props,来接收父组件传下来的数据</li><li>子组件可以通过触发自定义事件,来修改父组件的数据(事件名: update:属性名)</li><li><strong>注意:在Vue3中.v-model和sync修饰符二合一了,最终语法使用的是v-model的语法,事件名使用的是sync的事件名</strong></li></ol></li><li><p>全局事件总线</p><ol><li><p>一种组件间通信的方式，适用于<span style="color:red;">任意组件间通信</span></p></li><li><p>创建一个Vue实例对象,将其保存在Vue的原型对象上,以$bus属性进行保存</p><ol><li><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Vue</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">prototype</span><span style="color:#E1E4E8;">.$bus </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Vue</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">Vue</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">prototype</span><span style="color:#24292E;">.$bus </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Vue</span><span style="color:#24292E;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li></ol></li><li><p>在订阅者的代码中,使用$on去绑定全局事件监听</p><ol><li><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">this.$bus.$on(&#39;abc&#39;,(data)=&gt;{</span></span>
<span class="line"><span style="color:#e1e4e8;">      console.log(&#39;abc&#39;,data)</span></span>
<span class="line"><span style="color:#e1e4e8;">    })</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">this.$bus.$on(&#39;abc&#39;,(data)=&gt;{</span></span>
<span class="line"><span style="color:#24292e;">      console.log(&#39;abc&#39;,data)</span></span>
<span class="line"><span style="color:#24292e;">    })</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ol></li><li><p>在发布者的代码中,使用$emit去触发全局事件监听</p><ol><li><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">this.$bus.$emit(&#39;abc&#39;,this.msg)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">this.$bus.$emit(&#39;abc&#39;,this.msg)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li></ol><p>注意:$bus中,必须存放一个Vue的实例对象,否则后续使用on和emit会报错，可以使用$off对事件进行解绑。</p></li></ol></li></ol><h2 id="_4-找到对应组件实例对象" tabindex="-1">4. 找到对应组件实例对象 <a class="header-anchor" href="#_4-找到对应组件实例对象" aria-label="Permalink to &quot;4. 找到对应组件实例对象&quot;">​</a></h2><ol><li>$parent-&gt;找到当前组件的父组件实例对象</li><li>$root-&gt;找到当前组件树的根组件实例对象</li><li>$children-&gt;获取当前所有子组件组成的数组 <ol><li>该数组不具有响应式效果,修改内部对象的排列顺序,不会影响到页面上的展示顺序</li><li>该数组并不能保证排列顺序和书写顺序一致,因为有可能子组件使用到了组件懒加载写法 <ol><li>反过来说,只要子组件没有使用组件懒加载,那么当前children的顺序和书写顺序是一致的</li></ol></li></ol></li><li><strong>$refs-&gt;获取到template中,某个标签的原生DOM或者组件实例</strong><ol><li><strong>如果使用ref标记一个原生DOM标签,那么等下读取到的就是生成DOM节点</strong></li><li><strong>如果使用ref标记一个组件标签,那么读取到的就是他的组件实例对象</strong></li></ol></li></ol><h2 id="_5-attrs和-listener" tabindex="-1">5. $attrs和$listener <a class="header-anchor" href="#_5-attrs和-listener" aria-label="Permalink to &quot;5. $attrs和$listener&quot;">​</a></h2><ol><li>$attrs和$listener是两个特殊的属性，用于向子组件传递属性和监听事件。</li><li>$attrs他会收集当前组件,没有被props接收的标签属性。$attrs属性是一个包含父组件传递给子组件的所有非prop属性的对象。它可以用于将父组件中定义的属性自动传递给子组件。</li><li>$listener他会收集当前组件身上,所有的自定义事件,$listener属性是一个包含父组件传递给子组件的所有事件监听器的对象。它可以用于将父组件中定义的事件监听器自动传递给子组件。</li></ol><h2 id="_6-插槽" tabindex="-1">6. 插槽 <a class="header-anchor" href="#_6-插槽" aria-label="Permalink to &quot;6. 插槽&quot;">​</a></h2><ol><li>作用：让父组件可以向子组件指定位置插入html结构，也是一种组件间通信的方式，适用于 <strong style="color:red;">父组件 ===&gt; 子组件</strong> 。</li><li>分类：默认插槽、具名插槽、作用域插槽</li><li>默认插槽 <ol><li>父组件在子组件的成对标签中,写入一段页面结构 <ol><li>结构是在父组件里面写的,但是会在子组件里面显示</li></ol></li><li>子组件在自己的template中,使用slot组件,来显示传下来的插槽结构</li></ol></li><li>具名插槽 <ol><li>父组件在子组件的成对标签中,写入一段页面结构 <ol><li>父组件可以给插槽结构,使用v-slot指令取一个别名</li></ol></li><li>子组件在自己的template中,使用slot组件,来显示传下来的插槽结构 <ol><li>由于插槽已经具有别名,所以需要给slot组件,添加上name属性,输入对应的别名</li></ol></li><li>扩展:个人认为,默认插槽其实就是名称为default的具名插槽</li></ol></li><li>作用域插槽：<span style="color:red;">数据在组件的自身，但根据数据生成的结构需要组件的使用者来决定。</span><ol><li>父组件在子组件的成对标签中,写入一段页面结构 <ol><li>父组件可以给插槽结构,使用v-slot指令取一个别名</li></ol></li><li>子组件在自己的template中,使用slot组件,来显示传下来的插槽结构 <ol><li>由于插槽已经具有别名,所以需要给slot组件,添加上name属性,输入对应的别名</li></ol></li><li>子组件将需要使用到的数据,通过标签属性的形式,传给slot组件</li><li>插槽可以在#footer之后,添加=&quot;变量名&quot;,即可获取到子组件传递的数据,配合插值语法,来显示传递的数据</li></ol></li></ol><p><strong>以上三种插槽,都只有父传子,没有子传父!!!</strong></p><h2 id="七-vue中的mvvm源码分析" tabindex="-1">七. vue中的mvvm源码分析 <a class="header-anchor" href="#七-vue中的mvvm源码分析" aria-label="Permalink to &quot;七. vue中的mvvm源码分析&quot;">​</a></h2><h2 id="_1-mvvm源码第一部分-数据代理" tabindex="-1">1. MVVM源码第一部分：数据代理 <a class="header-anchor" href="#_1-mvvm源码第一部分-数据代理" aria-label="Permalink to &quot;1. MVVM源码第一部分：数据代理&quot;">​</a></h2><ol><li><p>什么是数据代理？</p><ol><li><p>数据代理是将一个对象中的所有直系属性名通过Object.defineProperty方法添加一份到另一个对象身上，这就是数据代理。vue中的数据代理也是通过Object.defineProperty方法，将下划线data对象中的直系属性名添加到组件实例对象上一份，这样能让我们更好操作数据，这里要注意代理的属性名是相同，但是他们不是同一个，就只有属性名是相同。如果vue中没有使用数据代理，我们在操作数据时需要通过this._data.xxx进行CRUD，使用了数据代理之后可以少写一层。</p></li><li><p>数据代理的次数跟data对象中的直系属性名的个数有关</p></li><li><p>vue中数据代理的流程</p><ol><li>使用Object.keys方法获取data对象中所有的直系属性名放到一个数组中。</li><li>对这个数组进行遍历，获取到每一个属性值，然后调用_proxy方法</li><li>在_proxy方法中，使用Object.defineProperty方法，给实例对象上添加全新的属性名，可以通过内部提供的get()和set()方法对属性值的操作，通过get()方法的返回值可以给这个全新的属性添加添加属性值，通过set()方法可以修改这个属性的属性值。</li></ol></li><li><p>数据代理：将data数据代理到实例对象上（方便将来操作data数据） 遍历所有data数据，通过Object.defineProperty()方法 将data中数据定义在实例对象上 内部就是通过get定义属性读取的方法，实际读取的是原数据_data 内部就是通过set定义属性设置的方法，实际设置的是原数据_data</p></li></ol></li></ol><h2 id="_2-mvvm源码第二部分-数据劫持" tabindex="-1">2. MVVM源码第二部分:数据劫持 <a class="header-anchor" href="#_2-mvvm源码第二部分-数据劫持" aria-label="Permalink to &quot;2. MVVM源码第二部分:数据劫持&quot;">​</a></h2><ol><li><p>什么是数据劫持</p><ol><li><p>数据劫持是当用户修改了data中的数据，vue通过某些操作，监视到用户修改data数据行为，所以vue可以在这个时候去修改页面。</p></li><li><p>数据劫持 遍历所有data数据，进行重新定义，将其定义成响应式。 也是通过Object.defineProperty()方法，重新定义属性get和set 此时会通过闭包的方式保存了一个dep对象， get中将来通过dep就能建立dep和watcher的联系 set中将来通过dep就能通知所有watcher去更新用户界面</p></li><li><p>数据劫持的目的：</p><p>​ 直接目的:将data对象中,所有的属性都变成了访问描述符,让他们拥有get/set方法。</p><p>最终目的:通过访问描述符的set方法,可以监视用户对于属性值的修改,从而实现响应式效果。</p><p>vue会监视data中所有层次的数据。(劫持的次数与data对象中所有的属性名个数有关)</p></li><li><p>vue中数据劫持的流程</p><ol><li>调用observe函数，判断是否有传入实参,而且实参是否是个对象如果不是,后续代码不执行，如果传入的是对象就调用Observer构造函数。</li><li>在Observer构造函数中调用walk方法传入data数据，在walk方法中使用Object.keys方法进行遍历获取data中所有的属性名组成一个数组，然后遍历得到数据，将内部每个属性名都进行数据劫持。</li><li>调用defineReactive方法创建一个全新的dep对象，将当前属性的属性值传入observe,如果是个对象,就进行深度数据劫持，在这个方法中进行递归调用。observe方法递归调用</li><li>使用Object.defineProperty方法将每个属性转换为getter/setter形式，这样，当属性被读取或修改时，Vue就能够捕捉到这个操作。当开发者修改data对象的某个属性的属性值时，将最新的数据传入observe,进行深度数据劫持，递归调用observe方法。setter会通知依赖进行更新。这个过程是通过Dep对象完成的。Dep对象会通知Watcher对象，然后Watcher对象会执行相关的更新操作，比如重新渲染组件等。data中的每一个响应式属性都会产生一个Dep对象。</li></ol></li></ol></li></ol><h2 id="_3-mvvm源码第三部分-模板解析" tabindex="-1">3. MVVM源码第三部分:模板解析 <a class="header-anchor" href="#_3-mvvm源码第三部分-模板解析" aria-label="Permalink to &quot;3.  MVVM源码第三部分:模板解析&quot;">​</a></h2><ol><li><p>目的:用于获取页面上的模版内容,并将内部的插值语法以及指令解析成对应的效果</p></li><li><p>vue源码中模板解析流程：</p><ol><li>构造调用new Compile方法,并传入目标元素和当前组件实例对象,开始准备解析模版</li><li>在Compile函数中，将目标元素中所有的子节点全部转移到文档碎片中，调用init函数开始解析模板，将解析完的文档碎片插入到页面上进行显示。</li><li>在init方法中会对所有的子节点进行遍历，如果遍历得到的节点是元素节点,就开始获取他身上所有的标签属性,准备解析指令，如果遍历得到的节点,是文本节点,而且它使用了插值语法,那么就开启解析插值语法。</li><li>在遍历插值语法过程中会调用bind方法，找到更新文本的文本更新器，将解析后插值语法的结果值传递给文本更新器，进行文本节点内容的更新。</li><li>每次执行bind方法,就会创建一个watcher对象，相当于每一个插值语法都会产生一个对应的watcher对象。</li></ol></li><li><p>vue中模板解析流程</p><ol><li>解析模板：Vue 会解析模板字符串，将其转化为抽象语法树(AST)。</li><li>静态分析：Vue 会对抽象语法树进行静态分析，检查模板中是否存在语法错误，并对模板中的所有变量进行静态分析，以便后续的编译和渲染过程中进行优化。</li><li>编译模板：Vue 会将模板编译为渲染函数。渲染函数是一个 JavaScript 函数，它接受一个参数，这个参数是一个包含模板中变量的数据对象，并返回一个 Virtual DOM 树。</li><li>生成 Virtual DOM：渲染函数在执行时会生成一个 Virtual DOM 树。Virtual DOM 是一个轻量级的 JavaScript 对象，它描述了真实 DOM 树的结构和属性，并且可以高效地进行比较和更新。</li><li>渲染：最后，Vue 会使用生成的 Virtual DOM 树进行渲染。Vue 使用 diff 算法比较新旧 Virtual DOM 树的差异，然后只更新必要的部分，以尽可能地减少 DOM 操作，提高性能。</li></ol><p>总结：Vue 的模板解析流程是将模板编译为渲染函数，然后使用渲染函数生成 Virtual DOM 树，最后使用 Virtual DOM 树进行渲染。这种方式可以在保持高度灵活性的同时提高渲染效率。</p></li></ol><h2 id="_4-object-defineproperty方法" tabindex="-1">4.Object.defineProperty方法 <a class="header-anchor" href="#_4-object-defineproperty方法" aria-label="Permalink to &quot;4.Object.defineProperty方法&quot;">​</a></h2><ol><li><p>两种形式的数据</p><ol><li><p>在ES6之前,属性都是以key和value形式存储数据的,这种属性称为数据描述符</p></li><li><p>在ES6之后,推出了一种全新的属性,他没有value值,只有get/set方法,这种属性称为访问描述符</p></li><li><p>如果开发者读取该属性的值,就会触发get方法,执行内部代码,并将函数的return结果作为属性值如果开发者修改该属性的值,就会触发set方法,执行内部代码</p></li><li><p>value值和get/set方法是互斥的，常见的对象声明写法,都是数据描述符,如果想要添加访问描述符,必须使用Object.defineProperty</p></li></ol></li><li><p>Object.defineProperty具体实现数据代理</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">Object.</span><span style="color:#B392F0;">defineProperty</span><span style="color:#E1E4E8;">(vm, </span><span style="color:#9ECBFF;">&quot;msg&quot;</span><span style="color:#E1E4E8;">, {</span></span>
<span class="line"><span style="color:#E1E4E8;">  configurable: </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;">, </span><span style="color:#6A737D;">//不能重复定义</span></span>
<span class="line"><span style="color:#E1E4E8;">  enumerable: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">, </span><span style="color:#6A737D;">//可以遍历</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">proxyGetter</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">     </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> vm._data[</span><span style="color:#9ECBFF;">&quot;msg&quot;</span><span style="color:#E1E4E8;">];</span></span>
<span class="line"><span style="color:#E1E4E8;">   },</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">proxySetter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">newVal</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    vm._data[</span><span style="color:#9ECBFF;">&quot;msg&quot;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> newVal;</span></span>
<span class="line"><span style="color:#E1E4E8;">   },</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">Object.</span><span style="color:#6F42C1;">defineProperty</span><span style="color:#24292E;">(vm, </span><span style="color:#032F62;">&quot;msg&quot;</span><span style="color:#24292E;">, {</span></span>
<span class="line"><span style="color:#24292E;">  configurable: </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">, </span><span style="color:#6A737D;">//不能重复定义</span></span>
<span class="line"><span style="color:#24292E;">  enumerable: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">, </span><span style="color:#6A737D;">//可以遍历</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">proxyGetter</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">     </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> vm._data[</span><span style="color:#032F62;">&quot;msg&quot;</span><span style="color:#24292E;">];</span></span>
<span class="line"><span style="color:#24292E;">   },</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">set</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">proxySetter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">newVal</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    vm._data[</span><span style="color:#032F62;">&quot;msg&quot;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> newVal;</span></span>
<span class="line"><span style="color:#24292E;">   },</span></span>
<span class="line"><span style="color:#24292E;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>代码意思：在vm对象上添加一个msg属性，当读取msg属性时会触发get()方法，get()方法的返回做为msg属性的属性值。当修改msg属性时会触发set()方法，set()方法接收到的参数为要修改的值，在函数体中进行赋值操作。vue中的数据代理和数据劫持都是使用这个api完成的。</p></li></ol><h2 id="_5-关于数据代理和数据劫持的一些问题" tabindex="-1">5. 关于数据代理和数据劫持的一些问题 <a class="header-anchor" href="#_5-关于数据代理和数据劫持的一些问题" aria-label="Permalink to &quot;5. 关于数据代理和数据劫持的一些问题&quot;">​</a></h2><ol><li>问题:触发数据代理的get/set方法的时候,是否一定会触发数据劫持的get/set?</li></ol><p>​ 回答:一定会,数据代理一定触发数据劫持你触发数据代理的get/set的时候,他们都会找到data对象,对同名属性做相同的事情由于data中所有的属性都被数据劫持过,所以一定会</p><ol start="2"><li>问题:数据劫持是否一定触发数据代理?</li></ol><p>​ 回答:不一定，只有修改/读取data对象中的属性才会触发数据劫持如果直接找到data对象,然后修改,就不会经过vm对象,就不会触发数据代理</p><ol start="3"><li>代码解析流程是怎么样的?</li></ol><p>​ 1.找到当前作用域中的vm变量,发现内部存储的居然是一个地址值</p><p>​ 2.通过地址值,找到堆内存中的vm对象</p><p>​ 3.js引擎会从vm对象身上,读取person属性,由于person属性是数据代理得到的 所以此处会触发person的get方法(数据代理第一次)</p><p>​ 4.数据代理的get方法中,会读取data对象中同名属性的值,相当于data[&quot;person&quot;]所以此处会触发data的person的get方法(数据劫持第一次)</p><p>​ 5.通过数据劫持的get方法,成功获取到了闭包中,存储的person对象的地址值</p><p>​ 6.js引擎会从堆内存中,找到地址值对应的person对象</p><p>​ 7.对person对象的name属性进行赋值操作,那么由于name属性也被进行了数据劫持,所以此处会触发数据劫持的set方法(数据劫持第二次)</p><p>​ 8.经过set方法之后,本次的最新结果会被更新到闭包中进行存储</p><h2 id="_6-响应式更新页面流程" tabindex="-1">6. 响应式更新页面流程 <a class="header-anchor" href="#_6-响应式更新页面流程" aria-label="Permalink to &quot;6. 响应式更新页面流程&quot;">​</a></h2><p>1.由于想要修改vm对象的msg属性,所以会触发数据代理的set方法</p><p>2.由于数据代理的set方法中,会接收本次的最新值,并修改data对象中的msg属性</p><p>3.由于data中的属性,都经过了数据劫持的处理,所以对其赋值会触发数据劫持的set方法</p><p>4.在数据劫持的set方法中,最终会触发dep.notify方法</p><p>5.在dep.notify方法中,会遍历subs数组,找到与自己相关的所有的watcher对象,调用他们的update方法</p><p>6.在watcher的update方法中,会调用run方法</p><p>7.在run方法中,</p><p>​ -获取到插值表达式最新的结果值</p><p>​ -获取到旧的结果值</p><p>​ -比较新旧结果值</p><p>​ -调用cb回调函数</p><p>8.在cb回调函数中,会调用缓存的textUpdater函数,用于更新页面上指定的节点</p><h2 id="八-vue2中数组的操作" tabindex="-1">八. vue2中数组的操作 <a class="header-anchor" href="#八-vue2中数组的操作" aria-label="Permalink to &quot;八. vue2中数组的操作&quot;">​</a></h2><h2 id="_1-vue2中如何操作数组-使其具有响应式" tabindex="-1">1. vue2中如何操作数组，使其具有响应式？ <a class="header-anchor" href="#_1-vue2中如何操作数组-使其具有响应式" aria-label="Permalink to &quot;1. vue2中如何操作数组，使其具有响应式？&quot;">​</a></h2><ol><li><p>可以使用数组重写过的7种方法来操作数组,就可以实现响应式的效果</p><p><strong>7种:push,pop,shift,unshift,splice,sort,reverse</strong></p></li></ol><h1 id="二十七-生命周期" tabindex="-1">二十七. 生命周期 <a class="header-anchor" href="#二十七-生命周期" aria-label="Permalink to &quot;二十七. 生命周期&quot;">​</a></h1><ol><li><p>Vue2一共具有多少个生命周期？</p><ol><li>vue2一共有11个，其中常用8个</li><li>服务器端有1个</li></ol></li><li><p>常用的八个生命周期叫什么?</p><ol><li>beforeCreate <ol><li><strong>beforeCreate之前,Vue正在初始化事件和初始化生命周期</strong> 2. created <ol><li>发送请求 <ol><li>由于js引擎是单线程解析代码的,所以created发请求会比mounted更早,相对的返回响应应该也更早</li></ol></li><li>注意:不要在这里做大量的逻辑操作 <ol><li>如果在这里阻塞10秒钟,页面就会晚10秒钟渲染</li></ol></li><li>beforeCreate之后created之前,Vue正在初始化注入和初始化响应式 <ol><li>注入:将一些本来没有放在组件实力上的数据,全部保存在组件实例身上 <ol><li>例如:将data函数返回的对象接收,并存放在this的$data属性身上 <ol><li><strong>将computed内部的计算属性,全部存放在this身上</strong></li><li><strong>将methods内部的方法,全部存放在this身上</strong></li><li><strong>像是数据代理也是属于数据注入的一部分</strong></li></ol></li></ol></li><li><strong>响应式:将data中的属性名,全部进行数据劫持,将他们从数据描述符变为访问描述符</strong></li></ol></li><li>beforeMount <ol><li>created之后beforeMount之前,Vue正在解析模版,将模版内容编译成render函数 <ol><li><strong>注意:beforeMount之前,只是准备render函数,并没有调用这个render函数</strong></li></ol></li></ol></li><li>mounted <ol><li>发送请求</li><li>操作DOM结构 <ol><li>只有这里能获取到DOM节点</li><li>例如:Swiper或者一些滑动库</li></ol></li><li>绑定事件</li><li>开启定时器</li><li>总结:这里由于组件已经挂载结束了,所以可以做到任何的事情,而且此处执行代码,对页面的影响较小</li><li><strong>beforeMount之后mounted之前,Vue会调用render函数,创建出当前组件的虚拟DOM,然后根据虚拟DOM创建对应真实DOM,然后替换掉页面上的指定区域,实现组件挂载功能</strong></li></ol></li></ol></li><li>更新阶段 <ol><li>beforeUpdate <ol><li>此处获取到的数据一定是最新的,但是DOM是旧的</li></ol></li><li>updated <ol><li>此处获取到的数据一定是最新的,DOM也是最新的</li><li>例如:二次操作真实DOM</li></ol></li></ol></li><li>卸载阶段 <ol><li>beforeDestroy <ol><li>清除定时器</li><li>解绑事件 <ol><li>使用@绑定的原生DOM事件,是否需要手动解绑? <ol><li>不需要,因为组件卸载的时候,它对应的DOM节点,也会销毁</li><li>除了垃圾IE以外,会出现DOM节点销毁了,但是事件还保留着,占用着内存</li></ol></li><li>当前组件使用@或者$on语法绑定的自定义事件,是否需要手动解绑? <ol><li>不需要,因为Vue组件会使用$listeners对象,收集当前组件实例所有的自定义事件</li><li>Vue会帮我们自动解绑这些自定义事件</li></ol></li><li>使用onclick或者addEventListener方法绑定的原生DOM事件,是否需要手动解绑? <ol><li>需要,因为组件虽然卸载了,但是window和document对象还没有销毁,那么在他们身上绑定的事件都会遗留</li></ol></li><li>使用on语法绑定的全局事件总线,是否需要手动解绑? <ol><li>需要,全局事件总线对象不会随着组件销毁而销毁,所以他会一直存活,那么在他身上绑定的事件,就会出现遗留</li></ol></li></ol></li><li>面试题:程序宕机的可能性(内存溢出) <ol><li>闭包没有及时释放</li><li>绑定在window或者document身上的事件没有及时解绑</li><li>在组件销毁的时候,没有解绑全局事件总线的事件</li><li>声明了太多的全局变量</li></ol></li></ol></li><li>destroyed 卸载完成</li></ol></li><li>keep-alive专用 <ol><li>activated(激活)</li><li>deactivated(失活)</li></ol></li><li>捕获后代组件报错 <ol><li>errorCaptured</li></ol></li><li>后端渲染专用 <ol><li>serverPrefetch</li><li>前端渲染就是服务器会返回一个空的html,然后在浏览器端对页面进行结构的添加 <ol><li>所以无法做到SEO优化,因为搜索引擎扫描html的时候,里面没有节点</li></ol></li><li>后端渲染就是服务器会返回一个完整的html,也就是说结构的添加是在服务器端,使用vue添加的, <ol><li>所以可以实现SEO优化,因为搜索引擎扫描html的时候,里面是有完整节点的</li></ol></li><li>最终总结:后端渲染和前端渲染用的都是Vue.js,只不过他们唯一的区别在于第一次结构的添加,一个在浏览器端,一个在服务器端,后续的操作都相同</li></ol></li></ol></li></ol></li></ol><h2 id="九-虚拟dom和真实dom" tabindex="-1">九. 虚拟DOM和真实DOM <a class="header-anchor" href="#九-虚拟dom和真实dom" aria-label="Permalink to &quot;九. 虚拟DOM和真实DOM&quot;">​</a></h2><h2 id="_1-什么是真实dom-什么是虚拟dom" tabindex="-1">1. 什么是真实DOM?什么是虚拟DOM? <a class="header-anchor" href="#_1-什么是真实dom-什么是虚拟dom" aria-label="Permalink to &quot;1. 什么是真实DOM?什么是虚拟DOM?&quot;">​</a></h2><ol><li><p>虚拟DOM是什么?真实DOM是什么?</p><ol><li><p>真实DOM</p><ol><li><p>他其实就是我们一阶段所学习的原生DOM</p></li><li><p>原生DOM就是标签/元素/对象(简单理解)</p></li><li><p>原生DOM其实就是js中的一种特殊的对象</p></li><li><p>原生DOM其实是根据页面上的标签,</p><p>抽象化之后得到的产物</p><ol><li>简单来说,就是根据页面上的标签,提取出他的重要信息,组成的一个<strong>js对象</strong></li></ol></li><li><p>原生DOM其实就是浏览器提供给开发者,用于修改页面的接口</p><ol><li>原生DOM对象与页面上的标签是<strong>双向映射关系</strong></li></ol></li></ol></li><li><p>虚拟DOM</p><ol><li><p>他其实也是一个js中的对象</p></li><li><p>他也是根据页面上的标签,抽象化之后的产物</p></li><li><p>它与页面上的标签只有</p><p>单向映射关系</p><ol><li>我们会根据页面上的标签生成虚拟DOM</li><li>但是我们修改虚拟DOM,不会影响到页面上的展示效果</li></ol></li><li><p>Vue中,虚拟DOM的构造函数是VNode</p></li></ol></li></ol></li><li><p>虚拟DOM和真实DOM的区别?(为什么有了真实DOM,还要推出虚拟DOM)</p><ol><li>体量大小(占用内存大小) <ol><li>虚拟DOM体积较小,因为他只记录开发者在意的核心属性</li><li>真实DOM体积较大,而且他身上记录的属性,绝大多数都是无用属性</li></ol></li><li>渲染性能 <ol><li>修改真实DOM,会导致页面发生重绘,甚至重排 <ol><li>连续修改多次真实DOM,并不会导致多次重绘重排,但是每次修改都需要通知GUI线程,涉及到了JS线程和GUI线程之间的通讯成本,会浪费很多的时间</li></ol></li><li>修改虚拟DOM,不会导致页面发生重绘重排 <ol><li>由于修改虚拟DOM只是JS线程一个人负责,所以都是内存级别的操作,不需要与GUI线程通讯</li></ol></li></ol></li></ol></li><li><p>既然虚拟DOM性能各方面都完爆真实DOM,为什么还要有真实DOM?</p><ol><li>虽然虚拟DOM很强,但是对他的修改,无法影响到页面,能影响到页面的只有真实DOM,所以他们两个不是竞争关系,而是互利关系</li><li>框架中,可以将多次的修改操作交给虚拟DOM去完成,将最终的结果交给真实DOM,由真实DOM控制页面,显示给用户观看</li></ol></li></ol><h2 id="十-在vue中key值的作用" tabindex="-1">十. 在vue中key值的作用 <a class="header-anchor" href="#十-在vue中key值的作用" aria-label="Permalink to &quot;十. 在vue中key值的作用&quot;">​</a></h2><ol><li>key值的使用 <ol><li>在遍历数据得到多个节点的时候,需要给每个节点都添加上一个唯一的key值</li></ol></li><li>常用作key值的数据有哪些? <ol><li>遍历得到的数据身上的唯一标识,例如:id,vid,userId等</li><li>遍历得到的数据的下标,例如:index</li><li>遍历得到的数据本身,例如:item</li></ol></li><li>key值的作用 <ol><li>与diff算法有关</li><li>当遍历的数据发生变化的时候,Vue会创建全新的虚拟DOM树,然后与旧的虚拟DOM树进行对比,找到可以复用的旧的真实DOM节点(而key值就是比较的关键)</li><li>first render(首次渲染): <ol><li>解析template模版,将其编译为render函数</li><li>将当前最新的数据传入render函数,那么render函数就会返回出最新的虚拟DOM</li><li>根据返回的虚拟DOM,创建对应的真实DOM</li><li>将真实DOM插入到页面上</li><li>最终GUI线程会根据最新的html,渲染给用户观看</li><li><strong>注意:首次渲染中,没有diff算法参与</strong></li></ol></li><li>update render(更新渲染): <ol><li>将当前最新的数据,传入render函数,生成最新的虚拟DOM</li><li><strong>比较新旧虚拟DOM,找到可以复用的真实DOM</strong></li><li><strong>如果没找到可以复用的真实DOM,直接创建全新的真实DOM</strong></li><li><strong>经过以上流程,最终合并所有的真实DOM,会获得一棵最新的真实DOM树</strong></li><li>将得到的最新的真实DOM树,替换掉页面上的指定区域</li><li>最终GUI线程会根据最新的html,渲染给用户观看</li><li>总结:流程2,3,4就是diff算法 <ol><li>diff算法就是在找到没有变化的节点,防止误杀情况的出现</li><li>diff算法只会<strong>同级比较</strong>,因为跨层级比较性能代价太大了</li></ol></li></ol></li></ol></li><li>如果使用下标作为key值,可能会出现什么问题? <ol><li>如果遍历数据不更新,key值用下标也不会出现问题 <ol><li>因为首次渲染中,没有diff算法参与</li></ol></li><li>input案例 <ol><li>在input案例中,diff算法生效了,她的确在比较虚拟DOM,而且也复用了真实DOM,但是很可惜复用错了 <ol><li>功能才是最重要的,性能其次</li></ol></li></ol></li><li>商品排序案例 <ol><li>在商品排序案例中,diff算法生效了,他的确在比较虚拟DOM,但是由于用下标作为key值,导致本来可以复用的节点全部复用失败,复用失败的结果就是全部生成全新的真实DOM <ol><li>在这个案例中,diff算法不仅没有优化性能,反而劣化了代码性能</li></ol></li></ol></li></ol></li><li>使用唯一标识作为key值的好处是什么? <ol><li>只要服务器端的数据没有发生变化,那么前端的节点就可以一直复用下去</li></ol></li></ol><h2 id="面试题-react、vue中的key有什么作用-key的内部原理" tabindex="-1">面试题：react、vue中的key有什么作用？（key的内部原理） <a class="header-anchor" href="#面试题-react、vue中的key有什么作用-key的内部原理" aria-label="Permalink to &quot;面试题：react、vue中的key有什么作用？（key的内部原理）&quot;">​</a></h2><p>​ 1. 虚拟DOM中key的作用：</p><p>​ key是虚拟DOM对象的标识，当数据发生变化时，Vue会根据【新数据】生成【新的虚拟DOM】,</p><p>​ 随后Vue进行【新虚拟DOM】与【旧虚拟DOM】的差异比较，比较规则如下：</p><p>​ 2.对比规则：</p><p>​ (1).旧虚拟DOM中找到了与新虚拟DOM相同的key：</p><p>​ ①.若虚拟DOM中内容没变, 直接使用之前的真实DOM！</p><p>​ ②.若虚拟DOM中内容变了, 则生成新的真实DOM，随后替换掉页面中之前的真实DOM。</p><p>​ (2).旧虚拟DOM中未找到与新虚拟DOM相同的key</p><p>​ 创建新的真实DOM，随后渲染到到页面。</p><p>​ 3. 用index作为key可能会引发的问题：</p><p>​ 1. 若对数据进行：逆序添加、逆序删除等破坏顺序操作:</p><p>​ 会产生没有必要的真实DOM更新 ==&gt; 界面效果没问题, 但效率低。</p><p>​ 2. 如果结构中还包含输入类的DOM：</p><p>​ 会产生错误DOM更新 ==&gt; 界面有问题。</p><p>​ 4. 开发中如何选择key?</p><p>​ 1.最好使用每条数据的唯一标识作为key, 比如id、手机号、身份证号、学号等唯一值。</p><p>​ 2.如果不存在对数据的逆序添加、逆序删除等破坏顺序操作，仅用于渲染列表用于展示，</p><p>​ 使用index作为key是没有问题的。</p><h2 id="deff算法查找规则" tabindex="-1">deff算法查找规则 <a class="header-anchor" href="#deff算法查找规则" aria-label="Permalink to &quot;deff算法查找规则&quot;">​</a></h2><p>查找规则: 1.新前对旧前 2.新后对旧后 3.新后对旧前 4.新前对旧后</p><p>​ 5.遍历整个列表,比较key值</p><p>新前,新后,旧前,旧后,其实是四个指针,所谓的指针,其实就是用来记录当前所在位置的变量</p><p>1.头部删除 2.头部添加 3.尾部删除 4.尾部添加 5.倒序排序</p><h2 id="十一-vuerouter相关分析" tabindex="-1">十一. VueRouter相关分析 <a class="header-anchor" href="#十一-vuerouter相关分析" aria-label="Permalink to &quot;十一. VueRouter相关分析&quot;">​</a></h2><h2 id="_1-vuerouter是什么" tabindex="-1">1. VueRouter是什么？ <a class="header-anchor" href="#_1-vuerouter是什么" aria-label="Permalink to &quot;1. VueRouter是什么？&quot;">​</a></h2><ol><li>他是一个npm包</li><li>他是Vue的可扩展插件(可以使用Vue.use)</li><li>它可以实现单页面应用(SPA) <ol><li>问题:请问什么是单页面应用? <ol><li>一个html文件就是一个页面,整个项目中,只有一个html文件,就是单页面项目 <ol><li>内部会使用DOM的CRUD方法,对html中的内容进行修改操作,实现一个html文件,显示多种页面的感觉</li></ol></li></ol></li><li>问题:请问不使用VueRouter,能否实现单页面应用? <ol><li>可以,甚至不使用框架,也可以实现单页面应用</li><li>虽然使用js或者jq等东西,也能实现单页面应用,但是由于需要操作的DOM节点太多了,所以很难去做</li></ol></li><li>问题:请问大家是否做过多页面应用? <ol><li>例如:尚品汇/大疆官网</li><li>多页面应用其实就是说,一个项目中,具有很多个html文件,对于这些文件之前的切换跳转,是使用a标签实现的</li></ol></li></ol></li></ol><h2 id="_2-vuerouter原理" tabindex="-1">2. VueRouter原理 <a class="header-anchor" href="#_2-vuerouter原理" aria-label="Permalink to &quot;2. VueRouter原理&quot;">​</a></h2><ol><li>vue-router的原理就是监听URL地址变化，从而渲染不同的组件。</li><li>VueRouter的核心原理是利用了浏览器的history API和hashchange事件。通过history API，VueRouter可以改变浏览器的URL地址，而不刷新页面。而hashchange事件则可以监听URL地址的变化。</li></ol><h3 id="_1-vue-router的模式" tabindex="-1">1. vue-router的模式 <a class="header-anchor" href="#_1-vue-router的模式" aria-label="Permalink to &quot;1. vue-router的模式&quot;">​</a></h3><ol><li><p>vue-router的模式主要有hash和history模式。</p><p>相同点：hash和history模式都可以作为前端的路由实现方案，他们都是在路由切换过程中不会刷新页面，不会向服务器发送请求(页面切换过程都是在浏览器本地通过js代码完成的)</p><p>不同点：</p><ol><li><p>hsah模式</p><p>hash模式在浏览器路径中带有一个#，在页面刷新时，#后面的路径信息不会发送给服务器。</p><p>hash模式的原理：<strong>hash模式是通过hashChange方法来监听路由地址的变化，一旦路由地址改变之后，就会根据当前的路由地址从路由配置中查找对应的组件(通过window.location.hash)，然后把组件显示到页面。</strong></p><p>hash模式的兼容性要高于history模式</p><p>缺点：1. 路径带有#比较丑。2. 由于hash路径会被当成锚点解析，就会导致真正的锚点无法正常使用</p></li><li><p>history模式</p><p>history模式在浏览器路径中没有#只有/，在页面刷新时，/后面的路径信息会发送给服务器。</p><p>histoty模式的原理：<strong>在使用history模式的时候，内部是通过history.pushState()和history.replaceState()等方式实现路由跳转的功能，从而实现浏览器历史记录的前进后退</strong></p><p>缺点：</p><p>​ 1.<strong>兼容性较差,因为使用到的history对象是html5的新特性</strong></p><ol start="2"><li><p><strong>项目上线的时候,需要做特殊的上线配置,否则项目将会出现问题</strong></p><ol start="3"><li><strong>问题:当用户在某个路由地址下,刷新当前页面,浏览器会将history路由地址,当作后端接口地址请求,后端服务器没有该接口,就会返回404,那么当前网页就会显示失败</strong></li><li>解决方法: 5. <strong>用户在某个路由地址下刷新页面(地址:/home)</strong> 6. <strong>浏览器会将前端路由地址/home,发送给后端公司服务器</strong> 7. 此时要求后端,自己没有的接口不要返回404,</li><li><strong>而是将当前项目html文件,返回给浏览器</strong> 9. <strong>浏览器接收到当前项目的html文件,解析该文件</strong> 10. <strong>解析的过程中,发现需要请求一个js文件,又向后端服务器发送请求</strong> 11. <strong>后端将网页需要使用的js文件返回值后,浏览器会自动执行内部的代码</strong> 12. 此时js文件中,VueRouter代码就会生效,开始自动获取到地址栏中的地址,</li><li><strong>将/home地址作为前端路由进行解析,然后自动显示对应的路由组件</strong></li></ol></li></ol></li></ol></li></ol><h3 id="_2-router-view和router-link" tabindex="-1">2. router-view和router-link <a class="header-anchor" href="#_2-router-view和router-link" aria-label="Permalink to &quot;2. router-view和router-link&quot;">​</a></h3><ol><li>router-view <ol><li>该组件会根据当前路由地址的变化,显示对应的路由组件</li><li>原理:其实router-view组件中,使用到了响应式原理 <ol><li><strong>只要路径数据发生了变化,router-view就会自动更新,展示最新的内容</strong></li></ol></li></ol></li><li>router-link <ol><li>默认生成一个a标签,用户点击a标签,就会发生路由跳转</li><li><strong>声明式导航的定义:通过标签的形式,引导用户进行跳转</strong></li><li>原理: <ol><li><strong>默认生成一个a标签</strong></li><li><strong>然后给该标签绑定点击事件</strong></li><li><strong>在事件回调函数中,禁用浏览器的默认行为,并且调用编程式导航实现路由跳转</strong></li></ol></li></ol></li></ol><h3 id="_3-router和-route" tabindex="-1">3. $router和$route <a class="header-anchor" href="#_3-router和-route" aria-label="Permalink to &quot;3. $router和$route&quot;">​</a></h3><ol><li><p>$router</p><ol><li><p>这是一个路由器对象,它是用来管理路由的</p></li><li><p>他会给开发者提供一些操作路由的API,例如:push,replace,go,back等</p></li><li><p>push方法</p><ol><li>该方法可以控制路由的跳转,并且是在真正的控制浏览器的历史记录栈</li><li><strong>push方法会保留上一个历史记录,也就是说可以回退到上个路由</strong></li><li><strong>项目中,绝大多数的路由跳转都是这类</strong></li><li><strong>编程式导航的定义:通过调用js的API,来强行控制用户的跳转</strong></li><li>原理: <ol><li><strong>hash模式下,其实是使用了location.assign(路径),来控制页面的路由的跳转</strong></li><li><strong>history模式下,其实是使用了history.pushState({},&quot;&quot;,路径),来控制页面的路由跳转</strong></li></ol></li></ol></li><li><p>replace方法</p><ol><li>该方法可以控制路由的跳转,并且是在真正的控制浏览器的历史记录栈</li><li><strong>replace方法不会保留上个历史记录,会对其进行覆盖处理,也就是说无法回到上个路由</strong></li><li><strong>项目中,少部分场景会使用到该方法,例如:login页面,order页面,pay页面等</strong>**</li><li>原理: <ol><li><strong>hash模式下,其实是使用了location.replace(路径),来控制页面的路由的跳转</strong></li><li><strong>history模式下,其实是使用了history.replaceState({},&quot;&quot;,路径),来控制页面的路由跳转</strong></li></ol></li></ol></li></ol></li><li><p>$route</p><ol><li>这是一个路由对象,它用于记录当前路由的重要信息</li><li>他会给开发者提供一些当前路由的参数信息</li><li>fullpath属性 <ol><li>存储这当前路由的完整地址</li></ol></li><li>query <ol><li>他是URL传参的一员</li><li>语法:&quot;/home?userId=100&quot;</li><li>可以将参数拼接在路径中进行传递</li></ol></li><li>params <ol><li>他也是URL传参的一员</li><li>语法:&quot;/home/100&quot;</li><li>可以将参数拼接在路径中进行传递</li><li>想使用这种传参方式,必须在声明路由对象的时候,在path中拼接占位符 <ol><li>例如:path:&quot;/home/:id&quot;</li></ol></li></ol></li><li>meta <ol><li>他不是URL传参的一员</li><li>该方案传递参数,需要在声明路由对象的时候进行添加 <ol><li>将需要传递的数据,写在与path,component属性同级的地方</li></ol></li></ol></li></ol></li></ol><h3 id="_4-路由守卫" tabindex="-1">4. 路由守卫 <a class="header-anchor" href="#_4-路由守卫" aria-label="Permalink to &quot;4. 路由守卫&quot;">​</a></h3><ol><li><p>作用：对路由进行权限控制</p></li><li><p>分类：全局守卫、独享守卫、组件内守卫</p><ol><li><p>全局守卫</p><ol><li><p>全局前置守卫</p><ol><li>在路由跳转之前触发。(其实当路由组件一上来挂载就会触发)</li></ol></li><li><p>全局解析守卫</p><ol><li>在异步路由组件解析结束之后,开始执行</li></ol></li><li><p>全局后置守卫</p><ol><li>在路由跳转之后触发。</li></ol></li></ol></li></ol><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">//全局前置守卫：初始化时执行、每次路由切换前执行</span></span>
<span class="line"><span style="color:#E1E4E8;">router.</span><span style="color:#B392F0;">beforeEach</span><span style="color:#E1E4E8;">((</span><span style="color:#FFAB70;">to</span><span style="color:#E1E4E8;">,</span><span style="color:#FFAB70;">from</span><span style="color:#E1E4E8;">,</span><span style="color:#FFAB70;">next</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">	console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;beforeEach&#39;</span><span style="color:#E1E4E8;">,to,from)</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(to.meta.isAuth){ </span><span style="color:#6A737D;">//判断当前路由是否需要进行权限控制</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(localStorage.</span><span style="color:#B392F0;">getItem</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;school&#39;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">===</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;atguigu&#39;</span><span style="color:#E1E4E8;">){ </span><span style="color:#6A737D;">//权限控制的具体规则</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#B392F0;">next</span><span style="color:#E1E4E8;">() </span><span style="color:#6A737D;">//放行</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#B392F0;">alert</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;暂无权限查看&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">// next({name:&#39;guanyu&#39;})</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#B392F0;">next</span><span style="color:#E1E4E8;">() </span><span style="color:#6A737D;">//放行</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//全局后置守卫：初始化时执行、每次路由切换后执行</span></span>
<span class="line"><span style="color:#E1E4E8;">router.</span><span style="color:#B392F0;">afterEach</span><span style="color:#E1E4E8;">((</span><span style="color:#FFAB70;">to</span><span style="color:#E1E4E8;">,</span><span style="color:#FFAB70;">from</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">	console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;afterEach&#39;</span><span style="color:#E1E4E8;">,to,from)</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(to.meta.title){ </span></span>
<span class="line"><span style="color:#E1E4E8;">		document.title </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> to.meta.title </span><span style="color:#6A737D;">//修改网页的title</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">		document.title </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;vue_test&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">//全局前置守卫：初始化时执行、每次路由切换前执行</span></span>
<span class="line"><span style="color:#24292E;">router.</span><span style="color:#6F42C1;">beforeEach</span><span style="color:#24292E;">((</span><span style="color:#E36209;">to</span><span style="color:#24292E;">,</span><span style="color:#E36209;">from</span><span style="color:#24292E;">,</span><span style="color:#E36209;">next</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">	console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;beforeEach&#39;</span><span style="color:#24292E;">,to,from)</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(to.meta.isAuth){ </span><span style="color:#6A737D;">//判断当前路由是否需要进行权限控制</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(localStorage.</span><span style="color:#6F42C1;">getItem</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;school&#39;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;atguigu&#39;</span><span style="color:#24292E;">){ </span><span style="color:#6A737D;">//权限控制的具体规则</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6F42C1;">next</span><span style="color:#24292E;">() </span><span style="color:#6A737D;">//放行</span></span>
<span class="line"><span style="color:#24292E;">		}</span><span style="color:#D73A49;">else</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6F42C1;">alert</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;暂无权限查看&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">// next({name:&#39;guanyu&#39;})</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">	}</span><span style="color:#D73A49;">else</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#6F42C1;">next</span><span style="color:#24292E;">() </span><span style="color:#6A737D;">//放行</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//全局后置守卫：初始化时执行、每次路由切换后执行</span></span>
<span class="line"><span style="color:#24292E;">router.</span><span style="color:#6F42C1;">afterEach</span><span style="color:#24292E;">((</span><span style="color:#E36209;">to</span><span style="color:#24292E;">,</span><span style="color:#E36209;">from</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">	console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;afterEach&#39;</span><span style="color:#24292E;">,to,from)</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(to.meta.title){ </span></span>
<span class="line"><span style="color:#24292E;">		document.title </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> to.meta.title </span><span style="color:#6A737D;">//修改网页的title</span></span>
<span class="line"><span style="color:#24292E;">	}</span><span style="color:#D73A49;">else</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">		document.title </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;vue_test&#39;</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><ol start="2"><li>独享守卫 <ol><li>当进入当前路由时触发</li></ol></li></ol><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">router</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">VueRouter</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">  routes: [</span></span>
<span class="line"><span style="color:#E1E4E8;">    {</span></span>
<span class="line"><span style="color:#E1E4E8;">      path: </span><span style="color:#9ECBFF;">&#39;/foo&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      component: Foo,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">beforeEnter</span><span style="color:#E1E4E8;">: (</span><span style="color:#FFAB70;">to</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">from</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">next</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">// ...</span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">  ]</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">router</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">VueRouter</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">  routes: [</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">      path: </span><span style="color:#032F62;">&#39;/foo&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      component: Foo,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">beforeEnter</span><span style="color:#24292E;">: (</span><span style="color:#E36209;">to</span><span style="color:#24292E;">, </span><span style="color:#E36209;">from</span><span style="color:#24292E;">, </span><span style="color:#E36209;">next</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// ...</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  ]</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ol start="3"><li><p>组件内守卫</p><ol><li>组件进入守卫：进入路由组件时触发</li><li>组件更新守卫：路由组件跳转还在当前路由组件时触发</li><li>组件离开守卫：离开路由组件之前触发</li></ol><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">export default {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">data</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">    return{</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">msg</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">123</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">  },</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">beforeRouteEnter</span><span style="color:#E1E4E8;">(to, from, next) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 在渲染该组件的对应路由被 confirm 前调用</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 不！能！获取组件实例 `this`</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 因为当守卫执行前，组件实例还没被创建</span></span>
<span class="line"><span style="color:#E1E4E8;">  },</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">beforeRouteUpdate</span><span style="color:#E1E4E8;">(to, from, next) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 在当前路由改变，但是该组件被复用时调用</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 举例来说，对于一个带有动态参数的路径 /foo/:id，在 /foo/1 和 /foo/2 之间跳转的时候，</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 由于会渲染同样的 Foo 组件，因此组件实例会被复用。而这个钩子就会在这个情况下被调用。</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 可以访问组件实例 `this`</span></span>
<span class="line"><span style="color:#E1E4E8;">  },</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">beforeRouteLeave</span><span style="color:#E1E4E8;">(to, from, next) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 导航离开该组件的对应路由时调用</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 可以访问组件实例 `this`</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">export default {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">data</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">    return{</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">msg</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">123</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">beforeRouteEnter</span><span style="color:#24292E;">(to, from, next) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 在渲染该组件的对应路由被 confirm 前调用</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 不！能！获取组件实例 `this`</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 因为当守卫执行前，组件实例还没被创建</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">beforeRouteUpdate</span><span style="color:#24292E;">(to, from, next) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 在当前路由改变，但是该组件被复用时调用</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 举例来说，对于一个带有动态参数的路径 /foo/:id，在 /foo/1 和 /foo/2 之间跳转的时候，</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 由于会渲染同样的 Foo 组件，因此组件实例会被复用。而这个钩子就会在这个情况下被调用。</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 可以访问组件实例 `this`</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">beforeRouteLeave</span><span style="color:#24292E;">(to, from, next) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 导航离开该组件的对应路由时调用</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 可以访问组件实例 `this`</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div></li></ol></li></ol><h2 id="十二-后台权限管理" tabindex="-1">十二. 后台权限管理 <a class="header-anchor" href="#十二-后台权限管理" aria-label="Permalink to &quot;十二. 后台权限管理&quot;">​</a></h2><h2 id="_1-路由级别权限管理思路流程" tabindex="-1">1. 路由级别权限管理思路流程： <a class="header-anchor" href="#_1-路由级别权限管理思路流程" aria-label="Permalink to &quot;1. 路由级别权限管理思路流程：&quot;">​</a></h2><ol><li>权限管理功能由两部分组成,第一部分是路由级别的权限管理,第二部分是按钮级别的权限管理</li></ol><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">1.将原本的常量路由数组切割为三个路由数组</span></span>
<span class="line"><span style="color:#E1E4E8;">        分为常量路由,异步路由,任意路由</span></span>
<span class="line"><span style="color:#E1E4E8;">2.当info接口请求成功之后,将用户的个人权限信息routes数组保存在VueX中</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">3.根据当前项目完整的异步路由数组,以及请求回来的路由别名数组进行过滤操作</span></span>
<span class="line"><span style="color:#E1E4E8;">    最终返回一个当前账号有资格访问的异步路由组成的数组</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">过滤流程</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        1.使用filter过滤当前完整的异步路由数组</span></span>
<span class="line"><span style="color:#E1E4E8;">        2.获取到每个路由对象的名称,去路由别名数组中查找</span></span>
<span class="line"><span style="color:#E1E4E8;">            如果有找到相同的名字,就说明有资格使用,就会保留这部分路由</span></span>
<span class="line"><span style="color:#E1E4E8;">            如果没找到就过滤掉</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        3.在遍历的过程中,我们还会观察当前路由对象是否有children数组,</span></span>
<span class="line"><span style="color:#E1E4E8;">            如果有children就需要递归处理该数组的内容</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">4.使用router.addRoutes语法,将流程3中得到的数组,进行动态注册</span></span>
<span class="line"><span style="color:#E1E4E8;">    注册完之后,用户就可以正常访问了</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">1.将原本的常量路由数组切割为三个路由数组</span></span>
<span class="line"><span style="color:#24292E;">        分为常量路由,异步路由,任意路由</span></span>
<span class="line"><span style="color:#24292E;">2.当info接口请求成功之后,将用户的个人权限信息routes数组保存在VueX中</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">3.根据当前项目完整的异步路由数组,以及请求回来的路由别名数组进行过滤操作</span></span>
<span class="line"><span style="color:#24292E;">    最终返回一个当前账号有资格访问的异步路由组成的数组</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">过滤流程</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        1.使用filter过滤当前完整的异步路由数组</span></span>
<span class="line"><span style="color:#24292E;">        2.获取到每个路由对象的名称,去路由别名数组中查找</span></span>
<span class="line"><span style="color:#24292E;">            如果有找到相同的名字,就说明有资格使用,就会保留这部分路由</span></span>
<span class="line"><span style="color:#24292E;">            如果没找到就过滤掉</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        3.在遍历的过程中,我们还会观察当前路由对象是否有children数组,</span></span>
<span class="line"><span style="color:#24292E;">            如果有children就需要递归处理该数组的内容</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">4.使用router.addRoutes语法,将流程3中得到的数组,进行动态注册</span></span>
<span class="line"><span style="color:#24292E;">    注册完之后,用户就可以正常访问了</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_2-路由级别权限管理遇到的bug" tabindex="-1">2. 路由级别权限管理遇到的BUG: <a class="header-anchor" href="#_2-路由级别权限管理遇到的bug" aria-label="Permalink to &quot;2. 路由级别权限管理遇到的BUG:&quot;">​</a></h2><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">1.左侧动态列表的展示问题</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">原因</span><span style="color:#E1E4E8;">:因为左侧动态列表是根据new VueRouter时候传入的routes数组进行生成的</span></span>
<span class="line"><span style="color:#E1E4E8;">            但是,我们现在实现了路由级别的权限管理,会对路由数组进行切割操作</span></span>
<span class="line"><span style="color:#E1E4E8;">                所以在new VueRouter的时候,传入的routes并不是完整的</span></span>
<span class="line"><span style="color:#B392F0;">解决</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    1.在Vuex中,创建状态menuList属性,用于存储当前账号能访问的所有的路由对象</span></span>
<span class="line"><span style="color:#E1E4E8;">    2.在帐号登陆之后,将常量路由,任意路由,以及当前帐号能访问的异步路由全部放入menuList中</span></span>
<span class="line"><span style="color:#E1E4E8;">    3.让左侧列表组件,映射最新的menuList数据,用于遍历显示左侧列表</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">2.登出低级权限帐号,再登陆高级权限帐号,权限管理出现问题</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">原因</span><span style="color:#E1E4E8;">:由于每次登陆帐号过滤权限的时候,都是使用同一个asyncRoutes进行过滤,</span></span>
<span class="line"><span style="color:#E1E4E8;">        所以导致上个帐号对asyncRoutes做的操作,会影响到下个帐号的权限管理</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">解决</span><span style="color:#E1E4E8;">:每次使用asyncRoutes数组的时候,都对其进行深拷贝操作,每次都是修改复印件,不会修改到原件</span></span>
<span class="line"><span style="color:#E1E4E8;">        就可以保证asyncRoutes数组的数据安全</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">3.在某个异步路由路径下,刷新当前页面,会出现白屏问题</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">原因</span><span style="color:#E1E4E8;">:因为当前addRoutes方法,注册路由是异步操作,</span></span>
<span class="line"><span style="color:#E1E4E8;">        开发者如果立即调用next方法,允许开发者跳转到异步路由,</span></span>
<span class="line"><span style="color:#E1E4E8;">        那么由于异步路由还没有注册成功,就会出现白屏</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">解决</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        将导航守卫中的next方法,</span><span style="color:#B392F0;">改为next</span><span style="color:#E1E4E8;">({</span><span style="color:#F97583;">...</span><span style="color:#E1E4E8;">to})</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">或者改为next</span><span style="color:#E1E4E8;">(to.path)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        以上两种写法,都会导致路由强制跳转两次</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">1.左侧动态列表的展示问题</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">原因</span><span style="color:#24292E;">:因为左侧动态列表是根据new VueRouter时候传入的routes数组进行生成的</span></span>
<span class="line"><span style="color:#24292E;">            但是,我们现在实现了路由级别的权限管理,会对路由数组进行切割操作</span></span>
<span class="line"><span style="color:#24292E;">                所以在new VueRouter的时候,传入的routes并不是完整的</span></span>
<span class="line"><span style="color:#6F42C1;">解决</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    1.在Vuex中,创建状态menuList属性,用于存储当前账号能访问的所有的路由对象</span></span>
<span class="line"><span style="color:#24292E;">    2.在帐号登陆之后,将常量路由,任意路由,以及当前帐号能访问的异步路由全部放入menuList中</span></span>
<span class="line"><span style="color:#24292E;">    3.让左侧列表组件,映射最新的menuList数据,用于遍历显示左侧列表</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">2.登出低级权限帐号,再登陆高级权限帐号,权限管理出现问题</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">原因</span><span style="color:#24292E;">:由于每次登陆帐号过滤权限的时候,都是使用同一个asyncRoutes进行过滤,</span></span>
<span class="line"><span style="color:#24292E;">        所以导致上个帐号对asyncRoutes做的操作,会影响到下个帐号的权限管理</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">解决</span><span style="color:#24292E;">:每次使用asyncRoutes数组的时候,都对其进行深拷贝操作,每次都是修改复印件,不会修改到原件</span></span>
<span class="line"><span style="color:#24292E;">        就可以保证asyncRoutes数组的数据安全</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">3.在某个异步路由路径下,刷新当前页面,会出现白屏问题</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">原因</span><span style="color:#24292E;">:因为当前addRoutes方法,注册路由是异步操作,</span></span>
<span class="line"><span style="color:#24292E;">        开发者如果立即调用next方法,允许开发者跳转到异步路由,</span></span>
<span class="line"><span style="color:#24292E;">        那么由于异步路由还没有注册成功,就会出现白屏</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">解决</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        将导航守卫中的next方法,</span><span style="color:#6F42C1;">改为next</span><span style="color:#24292E;">({</span><span style="color:#D73A49;">...</span><span style="color:#24292E;">to})</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">或者改为next</span><span style="color:#24292E;">(to.path)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        以上两种写法,都会导致路由强制跳转两次</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="_3-按钮级别权限管理功能实现" tabindex="-1">3. 按钮级别权限管理功能实现 <a class="header-anchor" href="#_3-按钮级别权限管理功能实现" aria-label="Permalink to &quot;3. 按钮级别权限管理功能实现&quot;">​</a></h2><p>需求:根据用户的账号权限,控制用户能够使用哪些功能(按钮)</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">拆解</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    1.根据用户的账号权限</span></span>
<span class="line"><span style="color:#E1E4E8;">        应该是在用户登录帐号的时候才能得知</span></span>
<span class="line"><span style="color:#E1E4E8;">            login接口</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">将用户的帐号密码发给服务器,兑换用户的唯一标识token字符串</span></span>
<span class="line"><span style="color:#E1E4E8;">                token字符串,是后端根据用户的唯一标识id,以及加密字符串,配合当前加密时间,编译得到的一个乱码字符串</span></span>
<span class="line"><span style="color:#E1E4E8;">                    服务器可以通过token反向解密得到原本的id   </span></span>
<span class="line"><span style="color:#E1E4E8;">        info接口</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">将用户的token字符串发给服务器,兑换用户的身份信息</span></span>
<span class="line"><span style="color:#E1E4E8;">            avatar</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">用户头像链接</span></span>
<span class="line"><span style="color:#E1E4E8;">            name</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">用户昵称</span></span>
<span class="line"><span style="color:#E1E4E8;">            buttons</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">用于实现按钮级别权限管理</span></span>
<span class="line"><span style="color:#E1E4E8;">                内部存储着当前账号能够使用的按钮权限信息</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#B392F0;">数据类型</span><span style="color:#E1E4E8;">:Array</span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">string</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">            routes</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">用于实现路由级别的权限管理</span></span>
<span class="line"><span style="color:#E1E4E8;">                内部存储这当前账号能够访问的路由别名</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#B392F0;">数据类型</span><span style="color:#E1E4E8;">:Array</span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">string</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">2.控制用户能够使用哪些功能</span></span>
<span class="line"><span style="color:#E1E4E8;">    让用户无法看到这些按钮,那么用户就没法使用</span></span>
<span class="line"><span style="color:#E1E4E8;">        可以使用v</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">if或者v</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">show隐藏标签</span></span>
<span class="line"><span style="color:#E1E4E8;">        v</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">show不太合适,因为对方可以使用浏览器控制台,通过修改样式来显示出该按钮</span></span>
<span class="line"><span style="color:#E1E4E8;">        v</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">if比较合适,因为使用v</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">if代表不解析该节点,相当于我们这行代码</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">拆解</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    1.根据用户的账号权限</span></span>
<span class="line"><span style="color:#24292E;">        应该是在用户登录帐号的时候才能得知</span></span>
<span class="line"><span style="color:#24292E;">            login接口</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">将用户的帐号密码发给服务器,兑换用户的唯一标识token字符串</span></span>
<span class="line"><span style="color:#24292E;">                token字符串,是后端根据用户的唯一标识id,以及加密字符串,配合当前加密时间,编译得到的一个乱码字符串</span></span>
<span class="line"><span style="color:#24292E;">                    服务器可以通过token反向解密得到原本的id   </span></span>
<span class="line"><span style="color:#24292E;">        info接口</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">将用户的token字符串发给服务器,兑换用户的身份信息</span></span>
<span class="line"><span style="color:#24292E;">            avatar</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">用户头像链接</span></span>
<span class="line"><span style="color:#24292E;">            name</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">用户昵称</span></span>
<span class="line"><span style="color:#24292E;">            buttons</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">用于实现按钮级别权限管理</span></span>
<span class="line"><span style="color:#24292E;">                内部存储着当前账号能够使用的按钮权限信息</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">数据类型</span><span style="color:#24292E;">:Array</span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">string</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            routes</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">用于实现路由级别的权限管理</span></span>
<span class="line"><span style="color:#24292E;">                内部存储这当前账号能够访问的路由别名</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">数据类型</span><span style="color:#24292E;">:Array</span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">string</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">2.控制用户能够使用哪些功能</span></span>
<span class="line"><span style="color:#24292E;">    让用户无法看到这些按钮,那么用户就没法使用</span></span>
<span class="line"><span style="color:#24292E;">        可以使用v</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">if或者v</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">show隐藏标签</span></span>
<span class="line"><span style="color:#24292E;">        v</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">show不太合适,因为对方可以使用浏览器控制台,通过修改样式来显示出该按钮</span></span>
<span class="line"><span style="color:#24292E;">        v</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">if比较合适,因为使用v</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">if代表不解析该节点,相当于我们这行代码</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="十三-取消请求功能" tabindex="-1">十三. 取消请求功能 <a class="header-anchor" href="#十三-取消请求功能" aria-label="Permalink to &quot;十三. 取消请求功能&quot;">​</a></h2><p>问题: 1.当路由组件切换显示的时候,上一个路由组件应该会卸载 2.虽然路由组件卸载了,但是他的请求并不会消失,还会继续请求,最终得到返回的响应数据</p><p>有可能出现:用户正在观看B路由,但是A路由的请求返回了,此时B路由显示的是A路由请求的数据 这个情况会一直持续到B路由的请求数据返回为止</p><p>根本问题:在离开A路由的时候,A路由的请求没有结束,导致影响到了其余组件的展示</p><p>需求:当路由发生跳转的时候,自动取消还未成功的请求 拆解: 1.当路由发生跳转的时候 通过导航守卫来监视路由的跳转 导航守卫执行顺序: 1.A组件的离开守卫 2.全局前置守卫 3.B路由的前置守卫 4.B组件的进入守卫</p><p>目前的需求并没说特定的某个路由或者某个组件跳转才要取消, 而是整个项目跳转路由都要取消请求,所以根据作用范围,决定使用全局前置守卫</p><p>2.自动取消还未成功的请求 继续拆解: 1.什么是自动? 开发者使用js代码帮用户做这个事情</p><p>​ 2.如何取消请求? ​ axios有一个CancelToken方法,可以用于取消请求</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">3.什么是还未成功的请求</span><span style="color:#F97583;">?</span></span>
<span class="line"><span style="color:#E1E4E8;">请求已经发出去了,但是响应还会返回,就是还未成功</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">问题</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;">如何知道哪些请求出去了</span><span style="color:#F97583;">?</span></span>
<span class="line"><span style="color:#E1E4E8;">回答</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;">通过请求拦截器就可以知道哪些请求要出去了</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">问题</span><span style="color:#E1E4E8;">:如何知道哪些响应返回了</span><span style="color:#F97583;">?</span></span>
<span class="line"><span style="color:#E1E4E8;">回答</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;">通过响应拦截器就可以知道哪些响应返回了</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">3.什么是还未成功的请求</span><span style="color:#D73A49;">?</span></span>
<span class="line"><span style="color:#24292E;">请求已经发出去了,但是响应还会返回,就是还未成功</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">问题</span><span style="color:#D73A49;">:</span><span style="color:#24292E;">如何知道哪些请求出去了</span><span style="color:#D73A49;">?</span></span>
<span class="line"><span style="color:#24292E;">回答</span><span style="color:#D73A49;">:</span><span style="color:#24292E;">通过请求拦截器就可以知道哪些请求要出去了</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">问题</span><span style="color:#24292E;">:如何知道哪些响应返回了</span><span style="color:#D73A49;">?</span></span>
<span class="line"><span style="color:#24292E;">回答</span><span style="color:#D73A49;">:</span><span style="color:#24292E;">通过响应拦截器就可以知道哪些响应返回了</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>实现代码：</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">//请求拦截器</span></span>
<span class="line"><span style="color:#E1E4E8;">request.interceptors.request.</span><span style="color:#B392F0;">use</span><span style="color:#E1E4E8;">((</span><span style="color:#FFAB70;">config</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// console.log(config)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 获取到当前发送出去的请求地址</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">url</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> config.url;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 通过调用CancelToken,可以给每个请求打上唯一标识</span></span>
<span class="line"><span style="color:#E1E4E8;">    config.cancelToken </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">CancelToken</span><span style="color:#E1E4E8;">((</span><span style="color:#FFAB70;">cb</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">// CancelToken的回调函数会立即执行</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">// cb本身是一个函数,只要调用cb函数,那么当前请求就会取消</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        store.</span><span style="color:#B392F0;">commit</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;ADD_FN&#39;</span><span style="color:#E1E4E8;">,{url:url,cb:cb})</span></span>
<span class="line"><span style="color:#E1E4E8;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> config</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span>
<span class="line"><span style="color:#6A737D;">//相应拦截器</span></span>
<span class="line"><span style="color:#E1E4E8;">request.interceptors.response.</span><span style="color:#B392F0;">use</span><span style="color:#E1E4E8;">((</span><span style="color:#FFAB70;">response</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// console.log(response)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 获取到本次请求成功的url链接</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">url</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> response.config.url;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    store.</span><span style="color:#B392F0;">commit</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;REMOVE_FN&#39;</span><span style="color:#E1E4E8;">,url);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> response.data;</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span>
<span class="line"><span style="color:#6A737D;">//store</span></span>
<span class="line"><span style="color:#B392F0;">mutations</span><span style="color:#E1E4E8;">:{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">ADD_FN</span><span style="color:#E1E4E8;">(state,{url,cb}){</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">// console.log(&#39;ADD_FN&#39;,url,cb)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">// 取消重复请求</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">// if(state.fns[url]){</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">//     state.fns[url]();</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">// }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        state.fns[url] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cb;</span></span>
<span class="line"><span style="color:#E1E4E8;">    },</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">REMOVE_FN</span><span style="color:#E1E4E8;">(state,url){</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">delete</span><span style="color:#E1E4E8;"> state.fns[url];</span></span>
<span class="line"><span style="color:#E1E4E8;">    },</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">CLEAR_FNS</span><span style="color:#E1E4E8;">(state){</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">// console.log(state)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">// 通过Object.values获取到所有取消请求的方法,然后遍历调用</span></span>
<span class="line"><span style="color:#E1E4E8;">        Object.</span><span style="color:#B392F0;">values</span><span style="color:#E1E4E8;">(state.fns).</span><span style="color:#B392F0;">forEach</span><span style="color:#E1E4E8;">((</span><span style="color:#FFAB70;">cb</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">cb</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        })</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">},</span></span>
<span class="line"><span style="color:#6A737D;">//全局前置守卫</span></span>
<span class="line"><span style="color:#E1E4E8;">router.</span><span style="color:#B392F0;">beforeEach</span><span style="color:#E1E4E8;">((</span><span style="color:#FFAB70;">to</span><span style="color:#E1E4E8;">,</span><span style="color:#FFAB70;">from</span><span style="color:#E1E4E8;">,</span><span style="color:#FFAB70;">next</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    store.</span><span style="color:#B392F0;">commit</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;CLEAR_FNS&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">next</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">//请求拦截器</span></span>
<span class="line"><span style="color:#24292E;">request.interceptors.request.</span><span style="color:#6F42C1;">use</span><span style="color:#24292E;">((</span><span style="color:#E36209;">config</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// console.log(config)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 获取到当前发送出去的请求地址</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">url</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> config.url;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 通过调用CancelToken,可以给每个请求打上唯一标识</span></span>
<span class="line"><span style="color:#24292E;">    config.cancelToken </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">CancelToken</span><span style="color:#24292E;">((</span><span style="color:#E36209;">cb</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// CancelToken的回调函数会立即执行</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// cb本身是一个函数,只要调用cb函数,那么当前请求就会取消</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        store.</span><span style="color:#6F42C1;">commit</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;ADD_FN&#39;</span><span style="color:#24292E;">,{url:url,cb:cb})</span></span>
<span class="line"><span style="color:#24292E;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> config</span></span>
<span class="line"><span style="color:#24292E;">})</span></span>
<span class="line"><span style="color:#6A737D;">//相应拦截器</span></span>
<span class="line"><span style="color:#24292E;">request.interceptors.response.</span><span style="color:#6F42C1;">use</span><span style="color:#24292E;">((</span><span style="color:#E36209;">response</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// console.log(response)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 获取到本次请求成功的url链接</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">url</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> response.config.url;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    store.</span><span style="color:#6F42C1;">commit</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;REMOVE_FN&#39;</span><span style="color:#24292E;">,url);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> response.data;</span></span>
<span class="line"><span style="color:#24292E;">})</span></span>
<span class="line"><span style="color:#6A737D;">//store</span></span>
<span class="line"><span style="color:#6F42C1;">mutations</span><span style="color:#24292E;">:{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">ADD_FN</span><span style="color:#24292E;">(state,{url,cb}){</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// console.log(&#39;ADD_FN&#39;,url,cb)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// 取消重复请求</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// if(state.fns[url]){</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//     state.fns[url]();</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        state.fns[url] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cb;</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">REMOVE_FN</span><span style="color:#24292E;">(state,url){</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">delete</span><span style="color:#24292E;"> state.fns[url];</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">CLEAR_FNS</span><span style="color:#24292E;">(state){</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// console.log(state)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// 通过Object.values获取到所有取消请求的方法,然后遍历调用</span></span>
<span class="line"><span style="color:#24292E;">        Object.</span><span style="color:#6F42C1;">values</span><span style="color:#24292E;">(state.fns).</span><span style="color:#6F42C1;">forEach</span><span style="color:#24292E;">((</span><span style="color:#E36209;">cb</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">cb</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        })</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">},</span></span>
<span class="line"><span style="color:#6A737D;">//全局前置守卫</span></span>
<span class="line"><span style="color:#24292E;">router.</span><span style="color:#6F42C1;">beforeEach</span><span style="color:#24292E;">((</span><span style="color:#E36209;">to</span><span style="color:#24292E;">,</span><span style="color:#E36209;">from</span><span style="color:#24292E;">,</span><span style="color:#E36209;">next</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    store.</span><span style="color:#6F42C1;">commit</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;CLEAR_FNS&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">next</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><h2 id="十四-vue3和vue2区别" tabindex="-1">十四. Vue3和Vue2区别 <a class="header-anchor" href="#十四-vue3和vue2区别" aria-label="Permalink to &quot;十四. Vue3和Vue2区别&quot;">​</a></h2><h2 id="vue3-比-vue2-有什么优势" tabindex="-1">Vue3 比 Vue2 有什么优势 <a class="header-anchor" href="#vue3-比-vue2-有什么优势" aria-label="Permalink to &quot;Vue3 比 Vue2 有什么优势&quot;">​</a></h2><ul><li>更好的代码组织和逻辑抽离 <ul><li>设计 <code>composition API </code>来代替 <code>option API</code></li><li>更便于可复用功能代码的封装提取, 代码可阅读性更高</li></ul></li><li>体积更小 <ul><li>将功能以多个函数提供出来, 我们会进行按需引入使用</li><li>引入<code>tree-shaking</code>, 可以在打包压缩时, 将无用模块“摇掉”</li></ul></li><li>性能更好/更快 <ul><li>使用Proxy代替defineProperty来实现响应式效果</li><li>diff算法优化: 静态虚拟节点添加静态标记, 不进行diff比较</li><li>静态提升: 静态虚拟节点提升到render的外面, 缓存起来, 不创建新的</li></ul></li><li>更好的 TS 支持 <ul><li>对TS的类型检查更友好</li></ul></li><li>更好的脚手架工具vite <ul><li>启动运行快了很多</li></ul></li></ul><h2 id="vue3-生命周期" tabindex="-1">Vue3 生命周期 <a class="header-anchor" href="#vue3-生命周期" aria-label="Permalink to &quot;Vue3 生命周期&quot;">​</a></h2><p><img src="/personalblog2/assets/vue3.bb0238f2.png" alt="image-20220827065513210"></p><h2 id="组合api-vs-选项api" tabindex="-1">组合API VS 选项API <a class="header-anchor" href="#组合api-vs-选项api" aria-label="Permalink to &quot;组合API VS 选项API&quot;">​</a></h2><ul><li><p>composition API 优点：</p><ul><li>更好的代码组织</li><li>更好的逻辑复用</li><li>更好的类型推导</li></ul></li><li><p>如何选择：</p><ul><li>不建议共用，会引起混乱</li><li>小型项目，业务逻辑简单，用 Options API</li><li>中大型项目，逻辑复杂，用 Composition API</li></ul></li><li><p>选项式 API（<code>Options API</code>）</p><ul><li><p>所有方法都写在 methods 中，如果 data 中数据越来越多，找数据会非常困难</p><div class="language-vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">h1</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">@click</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;changeCount&quot;</span><span style="color:#E1E4E8;">&gt;{{ count }}&lt;/</span><span style="color:#85E89D;">h1</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">default</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  name: </span><span style="color:#9ECBFF;">&#39;App&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">data</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">      count: </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">  },</span></span>
<span class="line"><span style="color:#E1E4E8;">  methods: {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">changeCount</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.count</span><span style="color:#F97583;">++</span></span>
<span class="line"><span style="color:#E1E4E8;">    },</span></span>
<span class="line"><span style="color:#E1E4E8;">  },</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">template</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">h1</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">@click</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;changeCount&quot;</span><span style="color:#24292E;">&gt;{{ count }}&lt;/</span><span style="color:#22863A;">h1</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">template</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">default</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  name: </span><span style="color:#032F62;">&#39;App&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">data</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">      count: </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">  methods: {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">changeCount</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.count</span><span style="color:#D73A49;">++</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></li></ul></li><li><p>组合式 API（<code>Composition API</code>）</p><ul><li><p>逻辑会清晰，可以让功能的代码集中抽取到一个函数中进行逻辑复用</p><div class="language-vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">h1</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">@click</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;changeNum&quot;</span><span style="color:#E1E4E8;">&gt;{{ num }}&lt;/</span><span style="color:#85E89D;">h1</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { ref } </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;vue&#39;</span></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">useNum</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">num</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ref</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">changeNum</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    num.value</span><span style="color:#F97583;">++</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> { changeNum, num }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">default</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  name: </span><span style="color:#9ECBFF;">&#39;App&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> { </span><span style="color:#79B8FF;">changeNum</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">num</span><span style="color:#E1E4E8;"> } </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">useNum</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">      changeNum,</span></span>
<span class="line"><span style="color:#E1E4E8;">      num,</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">  },</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">template</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">h1</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">@click</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;changeNum&quot;</span><span style="color:#24292E;">&gt;{{ num }}&lt;/</span><span style="color:#22863A;">h1</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">template</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { ref } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;vue&#39;</span></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">useNum</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">num</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ref</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">changeNum</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    num.value</span><span style="color:#D73A49;">++</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> { changeNum, num }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">default</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  name: </span><span style="color:#032F62;">&#39;App&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> { </span><span style="color:#005CC5;">changeNum</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">num</span><span style="color:#24292E;"> } </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">useNum</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">      changeNum,</span></span>
<span class="line"><span style="color:#24292E;">      num,</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div></li></ul></li></ul><h2 id="常用的组合api" tabindex="-1">常用的组合API <a class="header-anchor" href="#常用的组合api" aria-label="Permalink to &quot;常用的组合API&quot;">​</a></h2><ul><li>启动函数 <ul><li>setup()</li></ul></li><li>响应式: 核心 <ul><li>ref()</li><li>reactive()</li><li>computed()</li><li>watch()</li></ul></li><li>响应式: 工具 <ul><li>toRefs()</li></ul></li><li>生命周期勾子 <ul><li>onMounted()</li><li>onBeforeUnmount()</li></ul></li></ul><h2 id="比较vue2与vue3的响应式-重要" tabindex="-1">比较Vue2与Vue3的响应式(重要) <a class="header-anchor" href="#比较vue2与vue3的响应式-重要" aria-label="Permalink to &quot;比较Vue2与Vue3的响应式(重要)&quot;">​</a></h2><h2 id="vue2的响应式" tabindex="-1">vue2的响应式 <a class="header-anchor" href="#vue2的响应式" aria-label="Permalink to &quot;vue2的响应式&quot;">​</a></h2><ul><li>核心: <ul><li>对象: 通过defineProperty对对象的已有属性值的读取和修改进行劫持(监视/拦截)</li><li>数组: 通过重写数组更新数组一系列更新元素的方法来实现元素修改的劫持</li></ul></li></ul><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">Object.</span><span style="color:#B392F0;">defineProperty</span><span style="color:#E1E4E8;">(data, </span><span style="color:#9ECBFF;">&#39;count&#39;</span><span style="color:#E1E4E8;">, {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;"> () {}, </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;"> () {}</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">Object.</span><span style="color:#6F42C1;">defineProperty</span><span style="color:#24292E;">(data, </span><span style="color:#032F62;">&#39;count&#39;</span><span style="color:#24292E;">, {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">get</span><span style="color:#24292E;"> () {}, </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">set</span><span style="color:#24292E;"> () {}</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>问题 <ul><li>对象直接新添加的属性或删除已有属性, 界面不会自动更新</li><li>直接通过下标替换/添加元素或更新length, 界面不会自动更新</li></ul></li></ul><h2 id="vue3的响应式" tabindex="-1">Vue3的响应式 <a class="header-anchor" href="#vue3的响应式" aria-label="Permalink to &quot;Vue3的响应式&quot;">​</a></h2><ul><li>核心: <ul><li>通过Proxy(代理): 拦截对data任意属性的任意(13种)操作, 包括属性值的读写, 属性的添加, 属性的删除等...</li><li>通过 Reflect(反射): 动态对代理对象的相应属性进行特定的操作</li><li>文档: <ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy" target="_blank" rel="noreferrer">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect" target="_blank" rel="noreferrer">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect</a></li></ul></li></ul></li></ul><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">p</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Proxy</span><span style="color:#E1E4E8;">(data, {</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">// 拦截读取属性值</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">target</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">prop</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    	</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> Reflect.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(target, prop)</span></span>
<span class="line"><span style="color:#E1E4E8;">    },</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 拦截设置属性值或添加新属性</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">target</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">prop</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">value</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    	</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> Reflect.</span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;">(target, prop, value)</span></span>
<span class="line"><span style="color:#E1E4E8;">    },</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 拦截删除属性</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">deleteProperty</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">target</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">prop</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    	</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> Reflect.</span><span style="color:#B392F0;">deleteProperty</span><span style="color:#E1E4E8;">(target, prop)</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">p.name </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;tom&#39;</span></span>
<span class="line"><span style="color:#F97583;">&lt;!</span><span style="color:#79B8FF;">DOCTYPE</span><span style="color:#E1E4E8;"> html</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">html</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">lang</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;en&quot;</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">head</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">meta</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">charset</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;UTF-8&quot;</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">meta</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;viewport&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">content</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;width=device-width, initial-scale=1.0&quot;</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">title</span><span style="color:#E1E4E8;">&gt;Proxy 与 Reflect&lt;/</span><span style="color:#85E89D;">title</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">head</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">body</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    const user = {</span></span>
<span class="line"><span style="color:#E1E4E8;">      name: </span><span style="color:#9ECBFF;">&quot;John&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      age: </span><span style="color:#79B8FF;">12</span></span>
<span class="line"><span style="color:#E1E4E8;">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    /* </span></span>
<span class="line"><span style="color:#E1E4E8;">    proxyUser是代理对象, user是被代理对象</span></span>
<span class="line"><span style="color:#E1E4E8;">    后面所有的操作都是通过代理对象来操作被代理对象内部属性</span></span>
<span class="line"><span style="color:#E1E4E8;">    */</span></span>
<span class="line"><span style="color:#E1E4E8;">    const proxyUser = new Proxy(user, {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(target, prop) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        console.log(</span><span style="color:#9ECBFF;">&#39;劫持get()&#39;</span><span style="color:#E1E4E8;">, prop)</span></span>
<span class="line"><span style="color:#E1E4E8;">        return Reflect.get(target, prop)</span></span>
<span class="line"><span style="color:#E1E4E8;">      },</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;">(target, prop, val) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        console.log(</span><span style="color:#9ECBFF;">&#39;劫持set()&#39;</span><span style="color:#E1E4E8;">, prop, val)</span></span>
<span class="line"><span style="color:#E1E4E8;">        return Reflect.set(target, prop, val); </span><span style="color:#6A737D;">// (2)</span></span>
<span class="line"><span style="color:#E1E4E8;">      },</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">deleteProperty</span><span style="color:#E1E4E8;"> (target, prop) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        console.log(</span><span style="color:#9ECBFF;">&#39;劫持delete属性&#39;</span><span style="color:#E1E4E8;">, prop)</span></span>
<span class="line"><span style="color:#E1E4E8;">        return Reflect.deleteProperty(target, prop)</span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"><span style="color:#E1E4E8;">    });</span></span>
<span class="line"><span style="color:#E1E4E8;">    // 读取属性值</span></span>
<span class="line"><span style="color:#E1E4E8;">    console.log(proxyUser===user)</span></span>
<span class="line"><span style="color:#E1E4E8;">    console.log(proxyUser.name, proxyUser.age)</span></span>
<span class="line"><span style="color:#E1E4E8;">    // 设置属性值</span></span>
<span class="line"><span style="color:#E1E4E8;">    proxyUser.name = &#39;bob&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">    proxyUser.age = 13</span></span>
<span class="line"><span style="color:#E1E4E8;">    console.log(user)</span></span>
<span class="line"><span style="color:#E1E4E8;">    // 添加属性</span></span>
<span class="line"><span style="color:#E1E4E8;">    proxyUser.sex = &#39;男&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">    console.log(user)</span></span>
<span class="line"><span style="color:#E1E4E8;">    // 删除属性</span></span>
<span class="line"><span style="color:#E1E4E8;">    delete proxyUser.sex</span></span>
<span class="line"><span style="color:#E1E4E8;">    console.log(user)</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;/</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">body</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">html</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">p</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Proxy</span><span style="color:#24292E;">(data, {</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">// 拦截读取属性值</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">get</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">target</span><span style="color:#24292E;">, </span><span style="color:#E36209;">prop</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    	</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> Reflect.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(target, prop)</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 拦截设置属性值或添加新属性</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">set</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">target</span><span style="color:#24292E;">, </span><span style="color:#E36209;">prop</span><span style="color:#24292E;">, </span><span style="color:#E36209;">value</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    	</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> Reflect.</span><span style="color:#6F42C1;">set</span><span style="color:#24292E;">(target, prop, value)</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 拦截删除属性</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">deleteProperty</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">target</span><span style="color:#24292E;">, </span><span style="color:#E36209;">prop</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    	</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> Reflect.</span><span style="color:#6F42C1;">deleteProperty</span><span style="color:#24292E;">(target, prop)</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">p.name </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;tom&#39;</span></span>
<span class="line"><span style="color:#D73A49;">&lt;!</span><span style="color:#005CC5;">DOCTYPE</span><span style="color:#24292E;"> html</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">html</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">lang</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;en&quot;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">head</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">meta</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">charset</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;UTF-8&quot;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">meta</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;viewport&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">content</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;width=device-width, initial-scale=1.0&quot;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">title</span><span style="color:#24292E;">&gt;Proxy 与 Reflect&lt;/</span><span style="color:#22863A;">title</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">head</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">body</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    const user = {</span></span>
<span class="line"><span style="color:#24292E;">      name: </span><span style="color:#032F62;">&quot;John&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      age: </span><span style="color:#005CC5;">12</span></span>
<span class="line"><span style="color:#24292E;">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    /* </span></span>
<span class="line"><span style="color:#24292E;">    proxyUser是代理对象, user是被代理对象</span></span>
<span class="line"><span style="color:#24292E;">    后面所有的操作都是通过代理对象来操作被代理对象内部属性</span></span>
<span class="line"><span style="color:#24292E;">    */</span></span>
<span class="line"><span style="color:#24292E;">    const proxyUser = new Proxy(user, {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(target, prop) {</span></span>
<span class="line"><span style="color:#24292E;">        console.log(</span><span style="color:#032F62;">&#39;劫持get()&#39;</span><span style="color:#24292E;">, prop)</span></span>
<span class="line"><span style="color:#24292E;">        return Reflect.get(target, prop)</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">set</span><span style="color:#24292E;">(target, prop, val) {</span></span>
<span class="line"><span style="color:#24292E;">        console.log(</span><span style="color:#032F62;">&#39;劫持set()&#39;</span><span style="color:#24292E;">, prop, val)</span></span>
<span class="line"><span style="color:#24292E;">        return Reflect.set(target, prop, val); </span><span style="color:#6A737D;">// (2)</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">deleteProperty</span><span style="color:#24292E;"> (target, prop) {</span></span>
<span class="line"><span style="color:#24292E;">        console.log(</span><span style="color:#032F62;">&#39;劫持delete属性&#39;</span><span style="color:#24292E;">, prop)</span></span>
<span class="line"><span style="color:#24292E;">        return Reflect.deleteProperty(target, prop)</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"><span style="color:#24292E;">    });</span></span>
<span class="line"><span style="color:#24292E;">    // 读取属性值</span></span>
<span class="line"><span style="color:#24292E;">    console.log(proxyUser===user)</span></span>
<span class="line"><span style="color:#24292E;">    console.log(proxyUser.name, proxyUser.age)</span></span>
<span class="line"><span style="color:#24292E;">    // 设置属性值</span></span>
<span class="line"><span style="color:#24292E;">    proxyUser.name = &#39;bob&#39;</span></span>
<span class="line"><span style="color:#24292E;">    proxyUser.age = 13</span></span>
<span class="line"><span style="color:#24292E;">    console.log(user)</span></span>
<span class="line"><span style="color:#24292E;">    // 添加属性</span></span>
<span class="line"><span style="color:#24292E;">    proxyUser.sex = &#39;男&#39;</span></span>
<span class="line"><span style="color:#24292E;">    console.log(user)</span></span>
<span class="line"><span style="color:#24292E;">    // 删除属性</span></span>
<span class="line"><span style="color:#24292E;">    delete proxyUser.sex</span></span>
<span class="line"><span style="color:#24292E;">    console.log(user)</span></span>
<span class="line"><span style="color:#24292E;">  &lt;/</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">body</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">html</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br></div></div><h2 id="pinia-vs-vuex" tabindex="-1">pinia VS vuex <a class="header-anchor" href="#pinia-vs-vuex" aria-label="Permalink to &quot;pinia VS vuex&quot;">​</a></h2><ul><li>Pinia 没有 <code>mutations</code>, 在<code>actions</code> 中可以直接同步更新state或异步更新state</li><li>Pinia中可以包含多个store, 而且相互独立, 且不进行合并, 没有模块的嵌套结构</li><li>无需手动注册 store，创建出的store直接就可以使用</li><li>更好的 <code>TypeScript</code> 支持, 提示补全很到位</li></ul><h2 id="vue-router-v4的变化" tabindex="-1">vue-router V4的变化 <a class="header-anchor" href="#vue-router-v4的变化" aria-label="Permalink to &quot;vue-router V4的变化&quot;">​</a></h2><ul><li>创建路由器有变化 <ul><li>new Router 变成 createRouter</li><li>createWebHistory()与createWebHashHistory() 取代了 &#39;history&#39; 与 &#39;hash&#39;</li></ul></li><li>动态添加路由 <ul><li>以前可以一次添加多个: router.addRoutes(routes)</li><li>现在只能一次添加一个: router.addRoute(route)</li></ul></li><li>通配路由的path变了 <ul><li>以前的path: *</li><li>现在的path: /:pathMatch(.*)</li></ul></li></ul><h2 id="vue3-ts-语法" tabindex="-1">vue3 &amp; TS 语法 <a class="header-anchor" href="#vue3-ts-语法" aria-label="Permalink to &quot;vue3 &amp; TS 语法&quot;">​</a></h2><ul><li><p>声明接收props</p><div class="language-tsx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// 定义接口, 约束prop</span></span>
<span class="line"><span style="color:#F97583;">interface</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Props</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">count</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">number</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">updateCount</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">val</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">number</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">void</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#B392F0;">defineProps</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">Props</span><span style="color:#E1E4E8;">&gt;()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 定义接口, 约束prop</span></span>
<span class="line"><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Props</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">count</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">number</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">updateCount</span><span style="color:#24292E;">(</span><span style="color:#E36209;">val</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">number</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">void</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#6F42C1;">defineProps</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">Props</span><span style="color:#24292E;">&gt;()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li><li><p>原生事件</p><ul><li>原生标签上绑定</li><li>组件标签上绑定: 组件内部没有声明为自定义事件</li></ul></li><li><p>自定义事件</p><div class="language-jsx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// 声明事件</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">emit</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">defineEmits</span><span style="color:#E1E4E8;">&lt;{</span></span>
<span class="line"><span style="color:#E1E4E8;">  (</span><span style="color:#FFAB70;">e</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;xxx&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">val</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">string</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">void</span></span>
<span class="line"><span style="color:#E1E4E8;">  (</span><span style="color:#FFAB70;">e</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;click&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">val</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">object</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">void</span></span>
<span class="line"><span style="color:#E1E4E8;">  (</span><span style="color:#FFAB70;">e</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;increment&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">val</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">number</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">void</span></span>
<span class="line"><span style="color:#E1E4E8;">}&gt;()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// ts 中分发事件</span></span>
<span class="line"><span style="color:#B392F0;">emit</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;xxx&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;abc&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 模板中分发事件</span></span>
<span class="line"><span style="color:#B392F0;">$emit</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;increment&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 声明事件</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">emit</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">defineEmits</span><span style="color:#24292E;">&lt;{</span></span>
<span class="line"><span style="color:#24292E;">  (</span><span style="color:#E36209;">e</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;xxx&#39;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">val</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">string</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">void</span></span>
<span class="line"><span style="color:#24292E;">  (</span><span style="color:#E36209;">e</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;click&#39;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">val</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">object</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">void</span></span>
<span class="line"><span style="color:#24292E;">  (</span><span style="color:#E36209;">e</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;increment&#39;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">val</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">number</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">void</span></span>
<span class="line"><span style="color:#24292E;">}&gt;()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// ts 中分发事件</span></span>
<span class="line"><span style="color:#6F42C1;">emit</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;xxx&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;abc&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 模板中分发事件</span></span>
<span class="line"><span style="color:#6F42C1;">$emit</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;increment&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">5</span><span style="color:#24292E;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li><li><p>全局事件总线</p><ul><li>vue本身不再提供事件总线的API: 没有$on方法了</li><li>需要使用 <code>mitt</code> 或 <code>pubsub-js</code>第三方工具包</li></ul></li><li><p>v-model的本质</p><ul><li><p>原生标签上: 动态value和原生的input监听</p><div class="language-vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">input</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">type</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;text&quot;</span><span style="color:#E1E4E8;"> :</span><span style="color:#B392F0;">value</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">msg1</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> @</span><span style="color:#B392F0;">input</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">msg1</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">($event.target </span><span style="color:#F97583;">as</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">HTMLInputElement</span><span style="color:#E1E4E8;">).value</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> /&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">input</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">type</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;text&quot;</span><span style="color:#24292E;"> :</span><span style="color:#6F42C1;">value</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">msg1</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> @</span><span style="color:#6F42C1;">input</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">msg1</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">($event.target </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">HTMLInputElement</span><span style="color:#24292E;">).value</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> /&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p>组件标签上: 动态modelValue(默认)和自定义的input监听</p><div class="language-vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">custom-input</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">title</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;消息2&quot;</span><span style="color:#E1E4E8;"> :</span><span style="color:#B392F0;">modelValue</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">msg2</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> @</span><span style="color:#B392F0;">update</span><span style="color:#E1E4E8;">:</span><span style="color:#B392F0;">modelValue</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">msg2</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">$event</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> /&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">custom-input</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">title</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;消息2&quot;</span><span style="color:#24292E;"> :</span><span style="color:#6F42C1;">modelValue</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">msg2</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> @</span><span style="color:#6F42C1;">update</span><span style="color:#24292E;">:</span><span style="color:#6F42C1;">modelValue</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">msg2</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">$event</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> /&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li></ul></li><li><p>向外暴露方法</p><ul><li><p>组件内部的方法默认在外部是不能调用的</p></li><li><p>可以通过 defineExpose暴露</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">defineExpose</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">	borrowMoney</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">defineExpose</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">	borrowMoney</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul></li><li><p>通过ref得到组件对象</p><div class="language-vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">// 使用ref标识子组件</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">Son</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ref</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;sonRef&quot;</span><span style="color:#E1E4E8;">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">// 定义ref</span></span>
<span class="line"><span style="color:#E1E4E8;">const sonRef = ref&lt;</span><span style="color:#85E89D;">InstanceType</span><span style="color:#FDAEB7;font-style:italic;">&lt;typeof</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Son</span><span style="color:#E1E4E8;">&gt; | null&gt;(null)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">// 通过ref得到子组件对象, 调用其暴露的方法</span></span>
<span class="line"><span style="color:#E1E4E8;">sonRef.value?.borrowMoney(num)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">// 使用ref标识子组件</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">Son</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ref</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;sonRef&quot;</span><span style="color:#24292E;">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">// 定义ref</span></span>
<span class="line"><span style="color:#24292E;">const sonRef = ref&lt;</span><span style="color:#22863A;">InstanceType</span><span style="color:#B31D28;font-style:italic;">&lt;typeof</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Son</span><span style="color:#24292E;">&gt; | null&gt;(null)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">// 通过ref得到子组件对象, 调用其暴露的方法</span></span>
<span class="line"><span style="color:#24292E;">sonRef.value?.borrowMoney(num)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li></ul><h2 id="十五-vue2和vue3中deff算法的区别" tabindex="-1">十五. vue2和vue3中deff算法的区别 <a class="header-anchor" href="#十五-vue2和vue3中deff算法的区别" aria-label="Permalink to &quot;十五. vue2和vue3中deff算法的区别&quot;">​</a></h2><p>Vue 2.x 使用的是基于双向比较的 Virtual DOM diff 算法，也称为模板编译器，这意味着每当状态发生变化时，Vue 会对整个模板重新计算 Virtual DOM，找出需要更新的部分，然后将更新的内容渲染到真实 DOM 上。这个算法的缺点是当应用程序状态变得非常复杂时，性能可能会下降，因为它需要比较整个 Virtual DOM 树。</p><p>Vue 3.x 采用了一种称为“静态分析”的 diff 算法，称为“基于树的依赖跟踪系统”（Tree-shaking）。Vue 3.x 会在应用程序的编译过程中静态分析应用程序，将其组件拆分成更小的块，每个块都有自己的状态和更新函数。当状态发生变化时，只有受影响的块才会重新渲染，而不是整个应用程序。这种基于树的依赖跟踪系统可以大大提高应用程序的性能，并减少不必要的 DOM 更新。此外，Vue 3.x 还引入了一种称为“模板编译器”的新功能，允许将模板编译为可重用的 render 函数，进一步提高性能。</p></div></div></main><footer class="VPDocFooter" data-v-6b87e69f data-v-ef5dee53><!--[--><!--]--><!----><nav class="prev-next" data-v-ef5dee53><div class="pager" data-v-ef5dee53><a class="pager-link prev" href="/personalblog2/interview/interview_js.html" data-v-ef5dee53><span class="desc" data-v-ef5dee53>Previous page</span><span class="title" data-v-ef5dee53>面试题之基础作者总结</span></a></div><div class="pager" data-v-ef5dee53><a class="pager-link next" href="/personalblog2/interview/interview_adaptation.html" data-v-ef5dee53><span class="desc" data-v-ef5dee53>Next page</span><span class="title" data-v-ef5dee53>面试题之大屏适配问题</span></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-1919c326 data-v-e03eb2e1><div class="container" data-v-e03eb2e1><p class="message" data-v-e03eb2e1>本项目由个人独立开发完成</p><p class="copyright" data-v-e03eb2e1>Copyright © 2023- Rookie_Boy_小杨 </p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"index.md\":\"7d5eddd9\",\"guide_rest.md\":\"57eab7f4\",\"guide_my.md\":\"8036ecb7\",\"interview_interview_routeauthority.md\":\"1294bba4\",\"interview_interview_adaptation.md\":\"adbf4c0b\",\"pages_css_css_less.md\":\"6c2f8000\",\"pages_js_js_basics.md\":\"ce337759\",\"pages_js_js_grammar.md\":\"5e6e9955\",\"pages_pinia.md\":\"b2314031\",\"pages_js_js_bom.md\":\"76b3f6dd\",\"pages_git_git_order.md\":\"2e72aa16\",\"pages_js_js_array.md\":\"f1b20817\",\"pages_html.md\":\"001b3e1c\",\"pages_git_git.md\":\"f18315f4\",\"interview_interview_basics.md\":\"74abd66c\",\"pages_js_gj_js_deep.md\":\"20ad7088\",\"pages_react_react_diff.md\":\"739b0969\",\"pages_js_gj_js_callstack.md\":\"2e85d748\",\"pages_css_css_bootstrap.md\":\"cb66ed5e\",\"pages_js_js_statement.md\":\"ace3a16b\",\"pages_js_js_reg.md\":\"16dfde13\",\"pages_js_gj_js_prototype.md\":\"4939b7e4\",\"interview_interview_frame.md\":\"d75a7b71\",\"pages_js_gj_js_promise.md\":\"b0961e59\",\"pages_js_js_func.md\":\"c428ec95\",\"pages_js_js_summary.md\":\"cf97e900\",\"pages_vue_vue2_api.md\":\"7761939e\",\"pages_vue_vue3.md\":\"ac8e6392\",\"pages_react_redux.md\":\"95a2fcd8\",\"pages_js_js_object.md\":\"9c91406b\",\"pages_webpack.md\":\"1762ae2d\",\"pages_js_js_dom.md\":\"4f46b5bc\",\"pages_vue_vue2.md\":\"3b7cfd2b\",\"pages_js_js_event.md\":\"21fc16ed\",\"interview_interview_js.md\":\"828711c8\",\"pages_js_gj_js_es6.md\":\"e09cefcf\",\"pages_ts_typescript.md\":\"d7bddb14\",\"pages_css_css_attribute.md\":\"52bc2030\",\"pages_react_react_basics.md\":\"cac02d7b\",\"pages_ts_ts_tuozhan.md\":\"824f5b76\",\"pages_vue_vue2_basics.md\":\"010829d8\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"前端知识文档\",\"description\":\"前端个人博客\",\"base\":\"/personalblog2/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"关于我\",\"link\":\"/guide/my.md\"},{\"text\":\"友情链接\",\"items\":[{\"items\":[{\"text\":\"HTML\",\"link\":\"https://www.bilibili.com/video/BV1p84y1P7Z5/\"},{\"text\":\"CSS\",\"link\":\"https://www.bilibili.com/video/BV1p84y1P7Z5/\"},{\"text\":\"JavaScript基础\",\"link\":\"https://www.bilibili.com/video/BV1YW411T7GX/\"},{\"text\":\"JavaScript高级\",\"link\":\"https://www.bilibili.com/video/BV1uK411H7on/\"}]},{\"items\":[{\"text\":\"NodeJs\",\"link\":\"https://www.bilibili.com/video/BV1gM411W7ex/\"},{\"text\":\"Webpack\",\"link\":\"https://www.bilibili.com/video/BV14T4y1z7sw/\"},{\"text\":\"Git\",\"link\":\"https://www.bilibili.com/video/BV1wm4y1z7Dg\"},{\"text\":\"TypeScript\",\"link\":\"https://www.bilibili.com/video/BV1Xy4y1v7S2/\"}]},{\"items\":[{\"text\":\"Vue2\",\"link\":\"https://www.bilibili.com/video/BV1Zy4y1K7SH/\"},{\"text\":\"Vue3\",\"link\":\"https://www.bilibili.com/video/BV1Zy4y1K7SH/\"},{\"text\":\"React\",\"link\":\"https://www.bilibili.com/video/BV1wy4y1D7JT/\"}]}]},{\"text\":\"开始阅读\",\"items\":[{\"text\":\"HTML\",\"link\":\"/pages/html.md\"},{\"text\":\"CSS\",\"link\":\"/pages/css/css_attribute.md\"},{\"text\":\"JavaScript基础\",\"link\":\"/pages/js/js_basics.md\"},{\"text\":\"JavaScript高级\",\"link\":\"/pages/js_gj/js_prototype.md\"},{\"text\":\"Webpack\",\"link\":\"/pages/webpack.md\"},{\"text\":\"Git\",\"link\":\"/pages/git/git.md\"},{\"text\":\"TypeScript\",\"link\":\"/pages/ts/typescript.md\"},{\"text\":\"Vue2\",\"link\":\"/pages/vue/vue2.md\"},{\"text\":\"Vue3\",\"link\":\"/pages/vue/vue3.md\"},{\"text\":\"Pinia\",\"link\":\"/pages/pinia.md\"},{\"text\":\"React\",\"link\":\"/pages/react/react_basics.md\"}]},{\"text\":\"面试大全\",\"link\":\"/interview/interview_basics.md\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/\"}],\"lastUpdatedText\":\"最近更新更新时间\",\"lastUpdated\":true,\"logo\":\"/txt.png\",\"siteTitle\":\"博客\",\"sidebar\":{\"/pages/\":[{\"text\":\"🍓 H5的新特性\",\"collapsed\":true,\"items\":[{\"text\":\"H5新特性\",\"link\":\"/pages/html.md\"}]},{\"text\":\"🍇 Css样式\",\"collapsed\":true,\"items\":[{\"text\":\"CSS属性\",\"link\":\"/pages/css/css_attribute.md\"},{\"text\":\"CSS预处理器之less\",\"link\":\"/pages/css/css_less.md\"},{\"text\":\"BootStrap\",\"link\":\"/pages/css/css_bootstrap.md\"}]},{\"text\":\"🍎 JavaScript基础\",\"collapsed\":true,\"items\":[{\"text\":\"JavaScript简介\",\"link\":\"/pages/js/js_summary.md\"},{\"text\":\"JavaScript入门\",\"link\":\"/pages/js/js_basics.md\"},{\"text\":\"JavaScript语法\",\"link\":\"/pages/js/js_grammar.md\"},{\"text\":\"JavaScript语句\",\"link\":\"/pages/js/js_statement.md\"},{\"text\":\"JavaScript数组\",\"link\":\"/pages/js/js_array.md\"},{\"text\":\"JavaScript函数\",\"link\":\"/pages/js/js_func.md\"},{\"text\":\"JavaScript正则\",\"link\":\"/pages/js/js_Reg.md\"},{\"text\":\"JavaScript事件\",\"link\":\"/pages/js/js_event.md\"},{\"text\":\"JavaScriptDOM操作\",\"link\":\"/pages/js/js_DOM.md\"},{\"text\":\"JavaScriptBOM操作\",\"link\":\"/pages/js/js_BOM.md\"}]},{\"text\":\"🍏 JavaScript高级\",\"collapsed\":true,\"items\":[{\"text\":\"JavaScript原型和继承\",\"link\":\"/pages/js_gj/js_prototype.md\"},{\"text\":\"js调用栈和严格模式\",\"link\":\"/pages/js_gj/js_callstack.md\"},{\"text\":\"深克隆和浅克隆\",\"link\":\"/pages/js_gj/js_deep.md\"},{\"text\":\"ECMAScript6\",\"link\":\"/pages/js_gj/js_Es6.md\"},{\"text\":\"Promise\",\"link\":\"/pages/js_gj/js_Promise.md\"}]},{\"text\":\"🍌 Git\",\"collapsed\":true,\"items\":[{\"text\":\"Git教程\",\"link\":\"/pages/git/git.md\"},{\"text\":\"Git命令大全\",\"link\":\"/pages/git/git_order.md\"}]},{\"text\":\"🍍 TypeScript\",\"collapsed\":true,\"items\":[{\"text\":\"TypeScript教程\",\"link\":\"/pages/ts/typescript.md\"},{\"text\":\"TypeScript拓展\",\"link\":\"/pages/ts/ts_tuozhan.md\"}]},{\"text\":\"🍈 Webpack\",\"collapsed\":true,\"items\":[{\"text\":\"Webpack教程\",\"link\":\"/pages/webpack.md\"}]},{\"text\":\"🍉 Vue2\",\"collapsed\":true,\"items\":[{\"text\":\"Vue2(1)\",\"link\":\"/pages/vue/vue2.md\"},{\"text\":\"Vue2(2)\",\"link\":\"/pages/vue/vue2_basics.md\"},{\"text\":\"Vue2组件通信总结\",\"link\":\"/pages/vue/vue2_api.md\"}]},{\"text\":\"🍋 Vue3\",\"collapsed\":true,\"items\":[{\"text\":\"Vue3\",\"link\":\"/pages/vue/vue3.md\"}]},{\"text\":\"🍍 Pinia\",\"collapsed\":true,\"items\":[{\"text\":\"Pinia\",\"link\":\"/pages/pinia.md\"}]},{\"text\":\"🍒 React\",\"collapsed\":true,\"items\":[{\"text\":\"React教程\",\"link\":\"/pages/react/react_basics.md\"},{\"text\":\"React Diff算法\",\"link\":\"/pages/react/react_diff.md\"},{\"text\":\"Redux\",\"link\":\"/pages/react/redux.md\"}]}],\"/guide/\":[{\"text\":\"关于我\",\"collapsed\":true,\"items\":[{\"text\":\"关于\",\"link\":\"/guide/my.md\"},{\"text\":\"其他\",\"link\":\"/guide/rest.md\"}]}],\"/interview/\":[{\"text\":\"前端面试大全\",\"collapsed\":true,\"items\":[{\"text\":\"面试题之基础\",\"link\":\"/interview/interview_basics.md\"},{\"text\":\"面试题之基础作者总结\",\"link\":\"/interview/interview_js.md\"},{\"text\":\"面试题之框架\",\"link\":\"/interview/interview_frame.md\"},{\"text\":\"面试题之大屏适配问题\",\"link\":\"/interview/interview_adaptation.md\"},{\"text\":\"面试题之路由权限问题\",\"link\":\"/interview/interview_RouteAuthority.md\"}]}]},\"serviceWorker\":{\"updatePopup\":{\"message\":\"有新的内容.\",\"buttonText\":\"更新\"}},\"editLinks\":\"https://github.com/\",\"editLinkText\":\"在 GitHub 上编辑此页 ！\",\"search\":{\"provider\":\"local\"},\"footer\":{\"message\":\"本项目由个人独立开发完成\",\"copyright\":\"Copyright © 2023- Rookie_Boy_小杨 \"}},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}");</script>
    
  </body>
</html>